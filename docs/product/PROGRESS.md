# üìä Progress Tracker: Excel Import Identity

**–¶–µ–ª—å:** 100% –≤–∏–∑—É–∞–ª—å–Ω–∞—è –∏–¥–µ–Ω—Ç–∏—á–Ω–æ—Å—Ç—å –ø—Ä–∏ –∏–º–ø–æ—Ä—Ç–µ Excel —Ñ–∞–π–ª–æ–≤

**–¢–µ–∫—É—â–∏–π —Å—Ç–∞—Ç—É—Å:** ~75% ‚úÖ

---

## üéØ –ü–æ —Ñ–∞–∑–∞–º

| Phase | –ù–∞–∑–≤–∞–Ω–∏–µ | –°—Ç–∞—Ç—É—Å | –ò–¥–µ–Ω—Ç–∏—á–Ω–æ—Å—Ç—å | –î–∞—Ç–∞ |
|-------|----------|--------|--------------|------|
| **Phase 1** | –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –≤–∏–∑—É–∞–ª—å–Ω—ã–µ —ç–ª–µ–º–µ–Ω—Ç—ã | ‚úÖ **–ó–ê–í–ï–†–®–ï–ù–ê** | ~75% | 2025-10-05 |
| **Phase 2** | –†–∞—Å—à–∏—Ä–µ–Ω–Ω–æ–µ —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ | ‚è≥ –û–∂–∏–¥–∞–µ—Ç | ~85% | TBD |
| **Phase 3** | –ì—Ä–∞—Ñ–∏—á–µ—Å–∫–∏–µ —ç–ª–µ–º–µ–Ω—Ç—ã | ‚è≥ –û–∂–∏–¥–∞–µ—Ç | ~95% | TBD |

---

## ‚úÖ Phase 1: –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –≤–∏–∑—É–∞–ª—å–Ω—ã–µ —ç–ª–µ–º–µ–Ω—Ç—ã

### Etap 1.1: –ü–æ–ª–Ω–∞—è –ø–æ–¥–¥–µ—Ä–∂–∫–∞ —Å—Ç–∏–ª–µ–π ‚úÖ
- [x] –ü–∞—Ä—Å–∏–Ω–≥ fonts (name, size, bold, italic, underline, strikethrough, color)
- [x] –ü–∞—Ä—Å–∏–Ω–≥ fills (pattern type, fgColor, bgColor)
- [x] –ü–∞—Ä—Å–∏–Ω–≥ borders (left, right, top, bottom —Å style –∏ color)
- [x] –ü–∞—Ä—Å–∏–Ω–≥ alignment (horizontal, vertical, wrapText, textRotation, indent)
- [x] –°–æ–∑–¥–∞–Ω–∏–µ style-resolver.ts –¥–ª—è —Ä–∞–∑—Ä–µ—à–µ–Ω–∏—è styleId
- [x] –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å—Ç–∏–ª–µ–π –≤ UI

**–§–∞–π–ª—ã:**
- `src/core-ts/types.ts`
- `src/core-ts/read_xlsx.ts`
- `src/core-ts/style-resolver.ts`
- `src/components/EditableGridView.tsx`
- `src/components/WorkbookViewer.tsx`

### Etap 1.2: –£–ª—É—á—à–µ–Ω–Ω–∞—è –ø–æ–¥–¥–µ—Ä–∂–∫–∞ merged cells ‚úÖ
- [x] –°–æ–∑–¥–∞–Ω–∏–µ merge-utils.ts
- [x] parseRange() - –ø–∞—Ä—Å–∏–Ω–≥ "A1:B3"
- [x] shouldHideCell() - —Å–∫—Ä—ã—Ç–∏–µ slave cells
- [x] getMergedCellSize() - —Ä–∞—Å—á–µ—Ç rowSpan/colSpan
- [x] CSS Grid span –¥–ª—è –≤–∏–∑—É–∞–ª—å–Ω–æ–≥–æ –æ–±—ä–µ–¥–∏–Ω–µ–Ω–∏—è
- [x] –≠–∫—Å–ø–æ—Ä—Ç merged ranges –≤ .xlsx

**–§–∞–π–ª—ã:**
- `src/core-ts/merge-utils.ts`
- `src/components/EditableGridView.tsx`
- `src/core-ts/write_xlsx.ts`

### Etap 1.3: –ü–æ–ª–Ω–∞—è –ø–æ–¥–¥–µ—Ä–∂–∫–∞ —Ñ–æ—Ä–º—É–ª ‚úÖ
- [x] –ü–∞—Ä—Å–∏–Ω–≥ —Ç–µ–≥–∞ `<f>` –≤ parseSheet()
- [x] –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ —Ñ–æ—Ä–º—É–ª –≤ CellData.formula
- [x] –û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ —Ñ–æ—Ä–º—É–ª –≤ FormulaBar
- [x] –í—ã—á–∏—Å–ª–µ–Ω–∏–µ —Ñ–æ—Ä–º—É–ª —á–µ—Ä–µ–∑ HyperFormula
- [x] –≠–∫—Å–ø–æ—Ä—Ç —Ñ–æ—Ä–º—É–ª –≤ .xlsx

**–§–∞–π–ª—ã:**
- `src/core-ts/read_xlsx.ts`
- `src/core-ts/write_xlsx.ts` (—É–∂–µ –±—ã–ª–æ)

### Etap 1.4: –ü–æ–ª–Ω–∞—è –ø–æ–¥–¥–µ—Ä–∂–∫–∞ —á–∏—Å–ª–æ–≤—ã—Ö —Ñ–æ—Ä–º–∞—Ç–æ–≤ ‚úÖ
- [x] –°–æ–∑–¥–∞–Ω–∏–µ number-formatter.ts
- [x] –ü–æ–¥–¥–µ—Ä–∂–∫–∞ –≤—Å–µ—Ö –≤—Å—Ç—Ä–æ–µ–Ω–Ω—ã—Ö —Ñ–æ—Ä–º–∞—Ç–æ–≤ (0-49)
- [x] –ü–æ–¥–¥–µ—Ä–∂–∫–∞ custom —Ñ–æ—Ä–º–∞—Ç–æ–≤
- [x] –§–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ: –ø—Ä–æ—Ü–µ–Ω—Ç–æ–≤, –≤–∞–ª—é—Ç—ã, –Ω–∞—É—á–Ω–æ–π –Ω–æ—Ç–∞—Ü–∏–∏
- [x] –§–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ: –¥–∞—Ç –∏ –≤—Ä–µ–º–µ–Ω–∏
- [x] –ö–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏—è Excel serial date ‚Üí JS Date
- [x] –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è –≤ getCellDisplayValue()

**–§–∞–π–ª—ã:**
- `src/core-ts/number-formatter.ts`
- `src/hooks/useSpreadsheetEditor.ts`

---

## ‚è≥ Phase 2: –†–∞—Å—à–∏—Ä–µ–Ω–Ω–æ–µ —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

### Etap 2.1: –£—Å–ª–æ–≤–Ω–æ–µ —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ
- [ ] –ü–∞—Ä—Å–∏–Ω–≥ `<conditionalFormatting>` –∏–∑ xl/worksheets/sheetN.xml
- [ ] –ü–æ–¥–¥–µ—Ä–∂–∫–∞ Data Bars
- [ ] –ü–æ–¥–¥–µ—Ä–∂–∫–∞ Color Scales
- [ ] –ü–æ–¥–¥–µ—Ä–∂–∫–∞ Icon Sets
- [ ] –ü–æ–¥–¥–µ—Ä–∂–∫–∞ —Ñ–æ—Ä–º—É–ª-—É—Å–ª–æ–≤–∏–π
- [ ] –í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è –≤ UI

### Etap 2.2: Data Validation
- [ ] –ü–∞—Ä—Å–∏–Ω–≥ `<dataValidations>`
- [ ] –ü–æ–¥–¥–µ—Ä–∂–∫–∞ dropdown —Å–ø–∏—Å–∫–æ–≤
- [ ] –í–∞–ª–∏–¥–∞—Ü–∏—è –≤–≤–æ–¥–∞
- [ ] UI –¥–ª—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è validation rules

### Etap 2.3: –ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏
- [ ] –ü–∞—Ä—Å–∏–Ω–≥ xl/comments1.xml
- [ ] –°–≤—è–∑—ã–≤–∞–Ω–∏–µ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–µ–≤ —Å —è—á–µ–π–∫–∞–º–∏
- [ ] –í–∏–∑—É–∞–ª—å–Ω—ã–µ –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä—ã (–∫—Ä–∞—Å–Ω—ã–π —Ç—Ä–µ—É–≥–æ–ª—å–Ω–∏–∫)
- [ ] Hover-–ø—Ä–µ–≤—å—é –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–µ–≤
- [ ] –ü–∞–Ω–µ–ª—å —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–µ–≤

---

## ‚è≥ Phase 3: –ì—Ä–∞—Ñ–∏—á–µ—Å–∫–∏–µ —ç–ª–µ–º–µ–Ω—Ç—ã

### Etap 3.1: –ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è
- [ ] –ü–∞—Ä—Å–∏–Ω–≥ xl/drawings/drawing1.xml
- [ ] –ò–∑–≤–ª–µ—á–µ–Ω–∏–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π –∏–∑ xl/media/
- [ ] –ü–æ–∑–∏—Ü–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π (anchor points)
- [ ] –ú–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π
- [ ] –†–µ–Ω–¥–µ—Ä–∏–Ω–≥ –≤ UI

### Etap 3.2: –¢–∞–±–ª–∏—Ü—ã (Tables)
- [ ] –ü–∞—Ä—Å–∏–Ω–≥ xl/tables/table1.xml
- [ ] –í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è table headers
- [ ] –ü–æ–¥–¥–µ—Ä–∂–∫–∞ AutoFilter
- [ ] –ü–æ–¥–¥–µ—Ä–∂–∫–∞ totals row
- [ ] –°—Ç–∏–ª–∏–∑–∞—Ü–∏—è —Ç–∞–±–ª–∏—Ü

### Etap 3.3: –î–∏–∞–≥—Ä–∞–º–º—ã (Charts)
- [ ] –ü–∞—Ä—Å–∏–Ω–≥ xl/charts/chart1.xml
- [ ] –ü–æ–¥–¥–µ—Ä–∂–∫–∞ —Ç–∏–ø–æ–≤: column, bar, line, pie
- [ ] –ü–æ–¥–¥–µ—Ä–∂–∫–∞ —Ç–∏–ø–æ–≤: scatter, area, doughnut
- [ ] –°–≤—è–∑—ã–≤–∞–Ω–∏–µ –¥–∏–∞–≥—Ä–∞–º–º —Å –¥–∞–Ω–Ω—ã–º–∏
- [ ] –†–µ–Ω–¥–µ—Ä–∏–Ω–≥ –¥–∏–∞–≥—Ä–∞–º–º (—á–µ—Ä–µ–∑ chart.js –∏–ª–∏ recharts)

---

## üìà –ú–µ—Ç—Ä–∏–∫–∏ –ø–æ–∫—Ä—ã—Ç–∏—è

### –°—Ç—Ä—É–∫—Ç—É—Ä–∞
- [x] –ú–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã–µ –ª–∏—Å—Ç—ã - 100%
- [x] Row/Column properties - 100%
- [x] Merged ranges - 100%
- [x] Freeze panes - 100%

### –°—Ç–∏–ª–∏
- [x] Fonts - 95%
- [x] Fills - 95%
- [x] Borders - 95%
- [x] Alignment - 95%
- [x] Number formats - 90%

### –î–∞–Ω–Ω—ã–µ
- [x] –í—Å–µ —Ç–∏–ø—ã —è—á–µ–µ–∫ - 90%
- [x] SharedStrings - 100%
- [x] –§–æ—Ä–º—É–ª—ã - 90%

### –§–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ
- [ ] –£—Å–ª–æ–≤–Ω–æ–µ —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ - 0%
- [ ] Data Validation - 0%

### –û–±—ä–µ–∫—Ç—ã
- [ ] –ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏ - 0%
- [ ] –ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è - 0%
- [ ] –¢–∞–±–ª–∏—Ü—ã - 0%
- [ ] –î–∏–∞–≥—Ä–∞–º–º—ã - 0%

---

## üîß –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–π —Å—Ç–µ–∫

**–ü–∞—Ä—Å–∏–Ω–≥:**
- SAX-style XML parser (XmlSaxParser)
- ZipReader –¥–ª—è .xlsx —Ä–∞—Å–ø–∞–∫–æ–≤–∫–∏

**–í—ã—á–∏—Å–ª–µ–Ω–∏—è:**
- HyperFormula –¥–ª—è —Ñ–æ—Ä–º—É–ª

**UI:**
- React + TypeScript
- react-window –¥–ª—è –≤–∏—Ä—Ç—É–∞–ª–∏–∑–∞—Ü–∏–∏
- Tailwind CSS –¥–ª—è —Å—Ç–∏–ª–µ–π

**–•—Ä–∞–Ω–∏–ª–∏—â–µ:**
- WorkbookModel (in-memory)
- Map<string, CellData> –¥–ª—è —è—á–µ–µ–∫

---

## üìù –í–∞–∂–Ω—ã–µ –∑–∞–º–µ—Ç–∫–∏

1. **Excel serial dates:** Excel —Ö—Ä–∞–Ω–∏—Ç –¥–∞—Ç—ã –∫–∞–∫ —á–∏—Å–ª–æ –¥–Ω–µ–π —Å 1900-01-01 (—Å baggy 1900 leap year)
2. **ARGB colors:** Excel –∏—Å–ø–æ–ª—å–∑—É–µ—Ç ARGB —Ñ–æ—Ä–º–∞—Ç (#AARRGGBB), –Ω—É–∂–Ω–∞ –∫–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏—è –≤ HEX (#RRGGBB)
3. **Merged cells:** Master cell (top-left) —Å–æ–¥–µ—Ä–∂–∏—Ç –¥–∞–Ω–Ω—ã–µ, –æ—Å—Ç–∞–ª—å–Ω—ã–µ —è—á–µ–π–∫–∏ —Å–∫—Ä—ã—Ç—ã
4. **StyleId resolution:** cell.styleId ‚Üí cellXfs[styleId] ‚Üí fonts[fontId], fills[fillId], borders[borderId]
5. **Number formats:** Built-in (0-49) + custom formats –≤ workbook.numFmts

---

**–ü–æ—Å–ª–µ–¥–Ω–µ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ:** 2025-10-05
