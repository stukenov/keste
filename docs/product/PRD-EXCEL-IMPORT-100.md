# PRD: 100% –ò–¥–µ–Ω—Ç–∏—á–Ω—ã–π –ò–º–ø–æ—Ä—Ç Excel —Ñ–∞–π–ª–æ–≤

**–ü—Ä–æ–µ–∫—Ç:** Keste
**–í–µ—Ä—Å–∏—è:** 1.0
**–î–∞—Ç–∞ —Å–æ–∑–¥–∞–Ω–∏—è:** 2025-10-05
**–°—Ç–∞—Ç—É—Å:** üöß Phase 1 Complete ‚úÖ (~75% –∏–¥–µ–Ω—Ç–∏—á–Ω–æ—Å—Ç–∏)
**–ê–≤—Ç–æ—Ä:** Keste Team

---

## üìã –°–æ–¥–µ—Ä–∂–∞–Ω–∏–µ

1. [–¶–µ–ª—å](#—Ü–µ–ª—å)
2. [–¢–µ–∫—É—â–µ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ](#—Ç–µ–∫—É—â–µ–µ-—Å–æ—Å—Ç–æ—è–Ω–∏–µ)
3. [–ü—Ä–æ–±–µ–ª—ã –∏ –Ω–µ–¥–æ—Å—Ç–∞—é—â–∏–µ —ç–ª–µ–º–µ–Ω—Ç—ã](#–ø—Ä–æ–±–µ–ª—ã-–∏-–Ω–µ–¥–æ—Å—Ç–∞—é—â–∏–µ-—ç–ª–µ–º–µ–Ω—Ç—ã)
4. [–ü–ª–∞–Ω —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏](#–ø–ª–∞–Ω-—Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏)
5. [–î–µ—Ç–∞–ª—å–Ω–∞—è —Å–ø–µ—Ü–∏—Ñ–∏–∫–∞—Ü–∏—è](#–¥–µ—Ç–∞–ª—å–Ω–∞—è-—Å–ø–µ—Ü–∏—Ñ–∏–∫–∞—Ü–∏—è)
6. [–¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è](#—Ç–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ-—Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è)
7. [–ö—Ä–∏—Ç–µ—Ä–∏–∏ –ø—Ä–∏–µ–º–∫–∏](#–∫—Ä–∏—Ç–µ—Ä–∏–∏-–ø—Ä–∏–µ–º–∫–∏)
8. [–ü—Ä–∏–ª–æ–∂–µ–Ω–∏—è](#–ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è)

---

## üéØ –¶–µ–ª—å

**–î–æ–±–∏—Ç—å—Å—è 100% –≤–∏–∑—É–∞–ª—å–Ω–æ–π –∏–¥–µ–Ω—Ç–∏—á–Ω–æ—Å—Ç–∏ –ø—Ä–∏ –∏–º–ø–æ—Ä—Ç–µ Excel (.xlsx) —Ñ–∞–π–ª–æ–≤ –≤ Keste.**

–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –¥–æ–ª–∂–µ–Ω –≤–∏–¥–µ—Ç—å –∏–¥–µ–Ω—Ç–∏—á–Ω—É—é –∫–æ–ø–∏—é —Å–≤–æ–µ–≥–æ Excel —Ñ–∞–π–ª–∞ –ø—Ä–∏ –æ—Ç–∫—Ä—ã—Ç–∏–∏ –≤ Keste, –≤–∫–ª—é—á–∞—è:
- –í—Å–µ —Å—Ç–∏–ª–∏ (—à—Ä–∏—Ñ—Ç—ã, —Ü–≤–µ—Ç–∞, –≥—Ä–∞–Ω–∏—Ü—ã, –∑–∞–ª–∏–≤–∫–∏)
- –§–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ (–≤—ã—Ä–∞–≤–Ω–∏–≤–∞–Ω–∏–µ, –ø–µ—Ä–µ–Ω–æ—Å —Ç–µ–∫—Å—Ç–∞, –æ–±—ä–µ–¥–∏–Ω–µ–Ω–Ω—ã–µ —è—á–µ–π–∫–∏)
- –§–æ—Ä–º—É–ª—ã (—Å —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ–º –æ—Ä–∏–≥–∏–Ω–∞–ª—å–Ω–æ–≥–æ —Å–∏–Ω—Ç–∞–∫—Å–∏—Å–∞)
- –£—Å–ª–æ–≤–Ω–æ–µ —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ (data bars, color scales, icon sets)
- –ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏ (—Å –≤–∏–∑—É–∞–ª—å–Ω—ã–º–∏ –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä–∞–º–∏)
- –ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è (—Å –ø—Ä–∞–≤–∏–ª—å–Ω—ã–º –ø–æ–∑–∏—Ü–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ–º)
- –¢–∞–±–ª–∏—Ü—ã –∏ –¥–∏–∞–≥—Ä–∞–º–º—ã

---

## üìä –¢–µ–∫—É—â–µ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ

### –ß—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç (v0.6.0):

| –ö–∞—Ç–µ–≥–æ—Ä–∏—è | –ß—Ç–æ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ | –ü–æ–∫—Ä—ã—Ç–∏–µ |
|-----------|----------------|----------|
| **–î–∞–Ω–Ω—ã–µ** | –í—Å–µ —Ç–∏–ø—ã —è—á–µ–µ–∫ (n, s, b, d, str, e, inlineStr) | 90% ‚úÖ |
| **–î–∞–Ω–Ω—ã–µ** | SharedStrings (–¥–µ–¥—É–ø–ª–∏–∫–∞—Ü–∏—è —Å—Ç—Ä–æ–∫) | 100% ‚úÖ |
| **–°—Ç—Ä—É–∫—Ç—É—Ä–∞** | –ú–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã–µ –ª–∏—Å—Ç—ã | 100% ‚úÖ |
| **–°—Ç—Ä—É–∫—Ç—É—Ä–∞** | Row/Column properties (–≤—ã—Å–æ—Ç–∞, —à–∏—Ä–∏–Ω–∞, hidden) | 100% ‚úÖ |
| **–°—Ç—Ä—É–∫—Ç—É—Ä–∞** | Merged ranges (–æ–±—ä–µ–¥–∏–Ω–µ–Ω–Ω—ã–µ —è—á–µ–π–∫–∏) | 100% ‚úÖ |
| **–°—Ç—Ä—É–∫—Ç—É—Ä–∞** | Freeze panes (–∑–∞–∫—Ä–µ–ø–ª–µ–Ω–∏–µ –æ–±–ª–∞—Å—Ç–µ–π) | 100% ‚úÖ |
| **–°—Ç–∏–ª–∏** | Fonts, Fills, Borders, Alignment | 95% ‚úÖ |
| **–°—Ç–∏–ª–∏** | Number formats (–≤—Å–µ –≤—Å—Ç—Ä–æ–µ–Ω–Ω—ã–µ + custom) | 90% ‚úÖ |
| **–§–æ—Ä–º—É–ª—ã** | –ß—Ç–µ–Ω–∏–µ –∏ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ —Ñ–æ—Ä–º—É–ª | 90% ‚úÖ |
| **–§–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ** | –£—Å–ª–æ–≤–Ω–æ–µ —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ | 0% ‚ùå |
| **–û–±—ä–µ–∫—Ç—ã** | –ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏ | 0% ‚ùå |
| **–û–±—ä–µ–∫—Ç—ã** | –ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è | 0% ‚ùå |
| **–û–±—ä–µ–∫—Ç—ã** | –î–∏–∞–≥—Ä–∞–º–º—ã | 0% ‚ùå |

**–ò–¢–û–ì–û: ~75% –∏–¥–µ–Ω—Ç–∏—á–Ω–æ—Å—Ç–∏** üéâ (Phase 1 Complete)

### –¢–µ–∫—É—â–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –∏–º–ø–æ—Ä—Ç–∞:

```
File: src/core-ts/read_xlsx.ts

readXlsxToModel(buffer: ArrayBuffer)
  ‚îú‚îÄ> ZipReader (—Ä–∞—Å–ø–∞–∫–æ–≤–∫–∞ .xlsx)
  ‚îú‚îÄ> parseSharedStrings() ‚Üí string[]
  ‚îú‚îÄ> parseStyles() ‚Üí { numFmts, styles }  ‚ö†Ô∏è –ù–ï–ü–û–õ–ù–û–ï
  ‚îú‚îÄ> parseWorkbook() ‚Üí { sheets, definedNames }
  ‚îî‚îÄ> parseSheet() ‚Üí SheetModel
        ‚îú‚îÄ> –ü–∞—Ä—Å–∏—Ç <sheetData>
        ‚îú‚îÄ> –ü–∞—Ä—Å–∏—Ç <row> –∏ <c> (—è—á–µ–π–∫–∏)
        ‚îú‚îÄ> –ü–∞—Ä—Å–∏—Ç <mergeCell>
        ‚îú‚îÄ> –ü–∞—Ä—Å–∏—Ç <col> –∏ <row> properties
        ‚îî‚îÄ> –ù–ï –ø–∞—Ä—Å–∏—Ç: —Ñ–æ—Ä–º—É–ª—ã, —É—Å–ª–æ–≤–Ω–æ–µ —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ, –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏
```

---

## üîç –ü—Ä–æ–±–µ–ª—ã –∏ –Ω–µ–¥–æ—Å—Ç–∞—é—â–∏–µ —ç–ª–µ–º–µ–Ω—Ç—ã

### 1. **–°–¢–ò–õ–ò** (–ö—Ä–∏—Ç–∏—á–Ω–æ) ‚ùå

**–§–∞–π–ª:** `xl/styles.xml`

**–ß—Ç–æ –ù–ï –ø–∞—Ä—Å–∏—Ç—Å—è:**

```xml
<!-- FONTS - –ù–ï –ß–ò–¢–ê–Æ–¢–°–Ø -->
<fonts count="10">
  <font>
    <sz val="11"/>
    <color rgb="FF000000"/>
    <name val="Calibri"/>
    <b/>  <!-- bold -->
    <i/>  <!-- italic -->
    <u/>  <!-- underline -->
  </font>
</fonts>

<!-- FILLS - –ù–ï –ß–ò–¢–ê–Æ–¢–°–Ø -->
<fills count="5">
  <fill>
    <patternFill patternType="solid">
      <fgColor rgb="FFFFFF00"/>  <!-- yellow background -->
    </patternFill>
  </fill>
</fills>

<!-- BORDERS - –ù–ï –ß–ò–¢–ê–Æ–¢–°–Ø -->
<borders count="3">
  <border>
    <left style="thin">
      <color rgb="FF000000"/>
    </left>
    <right style="thin">
      <color rgb="FF000000"/>
    </right>
    <top style="thin"/>
    <bottom style="thin"/>
  </border>
</borders>

<!-- CELLXFS - –ü–ê–†–°–ò–¢–°–Ø –ß–ê–°–¢–ò–ß–ù–û -->
<cellXfs count="20">
  <xf numFmtId="0" fontId="2" fillId="3" borderId="1" xfId="0">
    <alignment horizontal="center" vertical="middle" wrapText="1"/>
  </xf>
</cellXfs>
```

**–¢–µ–∫—É—â–∏–π –∫–æ–¥ (–ü–†–û–ë–õ–ï–ú–ê):**

```typescript
// src/core-ts/read_xlsx.ts:98
function parseStyles(data: Uint8Array): { numFmts: Map<number, string>; styles: CellXfsStyle[] } {
  // ‚ùå –ü–∞—Ä—Å–∏—Ç —Ç–æ–ª—å–∫–æ numFmts –∏ –±–∞–∑–æ–≤—ã–π cellXfs
  // ‚ùå –ù–ï –ø–∞—Ä—Å–∏—Ç fonts, fills, borders, alignment
}
```

**–ü–æ—Å–ª–µ–¥—Å—Ç–≤–∏—è:**
- –í—Å–µ —è—á–µ–π–∫–∏ –≤—ã–≥–ª—è–¥—è—Ç –æ–¥–∏–Ω–∞–∫–æ–≤–æ (—á–µ—Ä–Ω—ã–π —Ç–µ–∫—Å—Ç, –±–µ–ª—ã–π —Ñ–æ–Ω)
- –ù–µ—Ç –∂–∏—Ä–Ω–æ–≥–æ/–∫—É—Ä—Å–∏–≤–Ω–æ–≥–æ —à—Ä–∏—Ñ—Ç–∞
- –ù–µ—Ç —Ü–≤–µ—Ç–Ω—ã—Ö —è—á–µ–µ–∫
- –ù–µ—Ç –≥—Ä–∞–Ω–∏—Ü
- –ù–µ—Ç –≤—ã—Ä–∞–≤–Ω–∏–≤–∞–Ω–∏—è

---

### 2. **–§–û–†–ú–£–õ–´** (–ö—Ä–∏—Ç–∏—á–Ω–æ) ‚ùå

**–§–∞–π–ª:** `xl/worksheets/sheet1.xml`

**–ß—Ç–æ –ù–ï –ø–∞—Ä—Å–∏—Ç—Å—è:**

```xml
<!-- –§–û–†–ú–£–õ–ê –í –Ø–ß–ï–ô–ö–ï -->
<c r="C1" s="0">
  <f>SUM(A1:A10)</f>  <!-- ‚ùå –ù–ï –ß–ò–¢–ê–ï–¢–°–Ø -->
  <v>55</v>           <!-- –ö–µ—à–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ - —á–∏—Ç–∞–µ—Ç—Å—è -->
</c>

<!-- SHARED FORMULA -->
<c r="D1" s="0">
  <f t="shared" ref="D1:D10" si="0">A1*2</f>
  <v>2</v>
</c>

<!-- ARRAY FORMULA -->
<c r="E1" s="0">
  <f t="array" ref="E1:E10">{=A1:A10*2}</f>
  <v>2</v>
</c>
```

**–¢–µ–∫—É—â–∏–π –∫–æ–¥ (–ü–†–û–ë–õ–ï–ú–ê):**

```typescript
// src/core-ts/read_xlsx.ts:219
} else if (name === 'f' && currentCell) {
  // Formula will be captured in text  ‚Üê ‚ùå –¢–û–õ–¨–ö–û –ö–û–ú–ú–ï–ù–¢–ê–†–ò–ô!
}
```

**–ü–æ—Å–ª–µ–¥—Å—Ç–≤–∏—è:**
- –§–æ—Ä–º—É–ª—ã –ù–ï —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è
- –ü—Ä–∏ —ç–∫—Å–ø–æ—Ä—Ç–µ —Ç–µ—Ä—è—é—Ç—Å—è –≤—Å–µ —Ñ–æ—Ä–º—É–ª—ã
- Formula bar –ø—É—Å—Ç–æ–π

---

### 3. **–£–°–õ–û–í–ù–û–ï –§–û–†–ú–ê–¢–ò–†–û–í–ê–ù–ò–ï** (–í—ã—Å–æ–∫–∏–π –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç) ‚ùå

**–§–∞–π–ª:** `xl/worksheets/sheet1.xml`

**–ß—Ç–æ –ù–ï –ø–∞—Ä—Å–∏—Ç—Å—è:**

```xml
<conditionalFormatting sqref="A1:A10">
  <cfRule type="dataBar" priority="1">
    <dataBar>
      <cfvo type="min"/>
      <cfvo type="max"/>
      <color rgb="FF638EC6"/>
    </dataBar>
  </cfRule>
</conditionalFormatting>

<conditionalFormatting sqref="B1:B10">
  <cfRule type="colorScale" priority="2">
    <colorScale>
      <cfvo type="min"/>
      <cfvo type="percentile" val="50"/>
      <cfvo type="max"/>
      <color rgb="FFF8696B"/>
      <color rgb="FFFFEB84"/>
      <color rgb="FF63BE7B"/>
    </colorScale>
  </cfRule>
</conditionalFormatting>

<conditionalFormatting sqref="C1:C10">
  <cfRule type="iconSet" priority="3">
    <iconSet iconSet="3TrafficLights1">
      <cfvo type="percent" val="0"/>
      <cfvo type="percent" val="33"/>
      <cfvo type="percent" val="67"/>
    </iconSet>
  </cfRule>
</conditionalFormatting>
```

**–ü–æ—Å–ª–µ–¥—Å—Ç–≤–∏—è:**
- –ù–µ—Ç data bars (–ø–æ–ª–æ—Å–æ–∫ –ø—Ä–æ–≥—Ä–µ—Å—Å–∞ –≤ —è—á–µ–π–∫–∞—Ö)
- –ù–µ—Ç —Ü–≤–µ—Ç–æ–≤—ã—Ö —à–∫–∞–ª (–≥—Ä–∞–¥–∏–µ–Ω—Ç–æ–≤)
- –ù–µ—Ç –Ω–∞–±–æ—Ä–æ–≤ –∏–∫–æ–Ω–æ–∫ (—Å—Ç—Ä–µ–ª–∫–∏, —Ñ–ª–∞–≥–∏, –∑–≤–µ–∑–¥—ã)

---

### 4. **DATA VALIDATION** (–í—ã—Å–æ–∫–∏–π –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç) ‚ùå

**–§–∞–π–ª:** `xl/worksheets/sheet1.xml`

**–ß—Ç–æ –ù–ï –ø–∞—Ä—Å–∏—Ç—Å—è:**

```xml
<dataValidations count="1">
  <dataValidation type="list" sqref="D1:D10">
    <formula1>"Option1,Option2,Option3"</formula1>
  </dataValidation>

  <dataValidation type="decimal" operator="between" sqref="E1:E10">
    <formula1>0</formula1>
    <formula2>100</formula2>
  </dataValidation>
</dataValidations>
```

**–ü–æ—Å–ª–µ–¥—Å—Ç–≤–∏—è:**
- –ù–µ—Ç dropdown —Å–ø–∏—Å–∫–æ–≤
- –ù–µ—Ç –≤–∞–ª–∏–¥–∞—Ü–∏–∏ –≤–≤–æ–¥–∞
- –ù–µ—Ç –≤–∏–∑—É–∞–ª—å–Ω—ã—Ö –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä–æ–≤

---

### 5. **–ö–û–ú–ú–ï–ù–¢–ê–†–ò–ò** (–°—Ä–µ–¥–Ω–∏–π –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç) ‚ùå

**–§–∞–π–ª:** `xl/comments1.xml`

**–ß—Ç–æ –ù–ï –ø–∞—Ä—Å–∏—Ç—Å—è:**

```xml
<comments>
  <authors>
    <author>John Doe</author>
  </authors>
  <commentList>
    <comment ref="A1" authorId="0">
      <text>
        <r>
          <t>This is a comment</t>
        </r>
      </text>
    </comment>
  </commentList>
</comments>
```

**–ü–æ—Å–ª–µ–¥—Å—Ç–≤–∏—è:**
- –ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏ –Ω–µ –≤–∏–¥–Ω—ã
- –ù–µ—Ç –∫—Ä–∞—Å–Ω–æ–≥–æ —Ç—Ä–µ—É–≥–æ–ª—å–Ω–∏–∫–∞ –≤ —É–≥–ª—É —è—á–µ–π–∫–∏

---

### 6. **–ò–ó–û–ë–†–ê–ñ–ï–ù–ò–Ø** (–°—Ä–µ–¥–Ω–∏–π –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç) ‚ùå

**–§–∞–π–ª—ã:** `xl/drawings/drawing1.xml`, `xl/media/image1.png`

**–ß—Ç–æ –ù–ï –ø–∞—Ä—Å–∏—Ç—Å—è:**

```xml
<xdr:twoCellAnchor>
  <xdr:from>
    <xdr:col>0</xdr:col>
    <xdr:row>0</xdr:row>
  </xdr:from>
  <xdr:to>
    <xdr:col>5</xdr:col>
    <xdr:row>10</xdr:row>
  </xdr:to>
  <xdr:pic>
    <xdr:blipFill>
      <a:blip r:embed="rId1"/>  <!-- —Å—Å—ã–ª–∫–∞ –Ω–∞ image1.png -->
    </xdr:blipFill>
  </xdr:pic>
</xdr:twoCellAnchor>
```

**–ü–æ—Å–ª–µ–¥—Å—Ç–≤–∏—è:**
- –ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è –Ω–µ –æ—Ç–æ–±—Ä–∞–∂–∞—é—Ç—Å—è
- –õ–æ–≥–æ—Ç–∏–ø—ã, –≥—Ä–∞—Ñ–∏–∫–∏, —Å–∫—Ä–∏–Ω—à–æ—Ç—ã —Ç–µ—Ä—è—é—Ç—Å—è

---

### 7. **–¢–ê–ë–õ–ò–¶–´ (Excel Tables)** (–°—Ä–µ–¥–Ω–∏–π –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç) ‚ùå

**–§–∞–π–ª:** `xl/tables/table1.xml`

**–ß—Ç–æ –ù–ï –ø–∞—Ä—Å–∏—Ç—Å—è:**

```xml
<table id="1" name="Table1" displayName="Table1" ref="A1:D10">
  <autoFilter ref="A1:D10"/>
  <tableColumns count="4">
    <tableColumn id="1" name="Name"/>
    <tableColumn id="2" name="Age"/>
    <tableColumn id="3" name="City"/>
    <tableColumn id="4" name="Salary"/>
  </tableColumns>
  <tableStyleInfo name="TableStyleMedium2"/>
</table>
```

**–ü–æ—Å–ª–µ–¥—Å—Ç–≤–∏—è:**
- –¢–∞–±–ª–∏—Ü—ã –≤—ã–≥–ª—è–¥—è—Ç –∫–∞–∫ –æ–±—ã—á–Ω—ã–µ —è—á–µ–π–∫–∏
- –ù–µ—Ç —Å—Ç–∏–ª—è —Ç–∞–±–ª–∏—Ü—ã (—á–µ—Ä–µ–¥—É—é—â–∏–µ—Å—è —Å—Ç—Ä–æ–∫–∏)
- –ù–µ—Ç —Ñ–∏–ª—å—Ç—Ä–æ–≤

---

### 8. **–î–ò–ê–ì–†–ê–ú–ú–´** (–ù–∏–∑–∫–∏–π –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç) ‚ùå

**–§–∞–π–ª:** `xl/charts/chart1.xml`

**–ü–æ—Å–ª–µ–¥—Å—Ç–≤–∏—è:**
- –î–∏–∞–≥—Ä–∞–º–º—ã –Ω–µ –æ—Ç–æ–±—Ä–∞–∂–∞—é—Ç—Å—è

---

## üìÖ –ü–ª–∞–Ω —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏

### **–û–±—â–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞:**

```
–§–ê–ó–ê 1: –ö—Ä–∏—Ç–∏—á–Ω—ã–µ –≤–∏–∑—É–∞–ª—å–Ω—ã–µ —ç–ª–µ–º–µ–Ω—Ç—ã (4-5 –¥–Ω–µ–π) ‚Üí 75% –∏–¥–µ–Ω—Ç–∏—á–Ω–æ—Å—Ç–∏
  ‚îî‚îÄ> –≠—Ç–∞–ø 1.1: –ü–æ–ª–Ω—ã–µ —Å—Ç–∏–ª–∏ (2-3 –¥–Ω—è)
  ‚îî‚îÄ> –≠—Ç–∞–ø 1.2: Merged cells —É–ª—É—á—à–µ–Ω–∏–µ (0.5 –¥–Ω—è)
  ‚îî‚îÄ> –≠—Ç–∞–ø 1.3: –§–æ—Ä–º—É–ª—ã (1 –¥–µ–Ω—å)
  ‚îî‚îÄ> –≠—Ç–∞–ø 1.4: Number formats (1 –¥–µ–Ω—å)

–§–ê–ó–ê 2: –í–∞–∂–Ω—ã–µ –≤–∏–∑—É–∞–ª—å–Ω—ã–µ —Ñ–∏—á–∏ (3-4 –¥–Ω—è) ‚Üí 85% –∏–¥–µ–Ω—Ç–∏—á–Ω–æ—Å—Ç–∏
  ‚îî‚îÄ> –≠—Ç–∞–ø 2.1: –£—Å–ª–æ–≤–Ω–æ–µ —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ (2 –¥–Ω—è)
  ‚îî‚îÄ> –≠—Ç–∞–ø 2.2: Data Validation (1 –¥–µ–Ω—å)
  ‚îî‚îÄ> –≠—Ç–∞–ø 2.3: –ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏ (1 –¥–µ–Ω—å)

–§–ê–ó–ê 3: –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —ç–ª–µ–º–µ–Ω—Ç—ã (5-8 –¥–Ω–µ–π) ‚Üí 95% –∏–¥–µ–Ω—Ç–∏—á–Ω–æ—Å—Ç–∏
  ‚îî‚îÄ> –≠—Ç–∞–ø 3.1: –ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è (2-3 –¥–Ω—è)
  ‚îî‚îÄ> –≠—Ç–∞–ø 3.2: –¢–∞–±–ª–∏—Ü—ã (2 –¥–Ω—è)
  ‚îî‚îÄ> –≠—Ç–∞–ø 3.3: –î–∏–∞–≥—Ä–∞–º–º—ã (3-5 –¥–Ω–µ–π)
```

---

## üöÄ –§–ê–ó–ê 1: –ö—Ä–∏—Ç–∏—á–Ω—ã–µ –≤–∏–∑—É–∞–ª—å–Ω—ã–µ —ç–ª–µ–º–µ–Ω—Ç—ã

**–¶–µ–ª—å:** –° 35% –¥–æ 75% –∏–¥–µ–Ω—Ç–∏—á–Ω–æ—Å—Ç–∏
**–í—Ä–µ–º—è:** 4-5 –¥–Ω–µ–π
**–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç:** üî¥ –í—ã—Å—à–∏–π

---

### **–≠—Ç–∞–ø 1.1: –ü–æ–ª–Ω–∞—è –ø–æ–¥–¥–µ—Ä–∂–∫–∞ —Å—Ç–∏–ª–µ–π** (2-3 –¥–Ω—è)

#### –ó–∞–¥–∞—á–∏:

**1.1.1 –†–∞—Å—à–∏—Ä–∏—Ç—å —Ç–∏–ø—ã –¥–∞–Ω–Ω—ã—Ö**

**–§–∞–π–ª:** `src/core-ts/types.ts`

**–î–µ–π—Å—Ç–≤–∏—è:**
```typescript
// –î–æ–±–∞–≤–∏—Ç—å –≤ WorkbookModel:
export interface WorkbookModel {
  // ... —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–µ –ø–æ–ª—è
  fonts: Font[];          // –ù–û–í–û–ï
  fills: Fill[];          // –ù–û–í–û–ï
  borders: Border[];      // –ù–û–í–û–ï
  cellXfs: CellXf[];      // –†–ê–°–®–ò–†–ò–¢–¨
}

// –ù–û–í–´–ï –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å—ã:
export interface Font {
  id: number;
  name: string;           // "Calibri"
  size: number;           // 11
  bold: boolean;
  italic: boolean;
  underline: boolean;
  strikethrough: boolean;
  color: string;          // "FF000000" (ARGB)
}

export interface Fill {
  id: number;
  patternType: 'none' | 'solid' | 'gray125' | 'lightGray' | 'darkGray';
  fgColor?: string;       // Foreground color (ARGB)
  bgColor?: string;       // Background color (ARGB)
}

export interface Border {
  id: number;
  top?: BorderEdge;
  right?: BorderEdge;
  bottom?: BorderEdge;
  left?: BorderEdge;
  diagonal?: BorderEdge;
}

export interface BorderEdge {
  style: 'thin' | 'medium' | 'thick' | 'dashed' | 'dotted' | 'double' | 'hair' | 'mediumDashed';
  color?: string;         // ARGB
}

export interface CellXf {
  id: number;
  numFmtId?: number;
  fontId?: number;
  fillId?: number;
  borderId?: number;
  xfId?: number;
  applyFont?: boolean;
  applyFill?: boolean;
  applyBorder?: boolean;
  applyAlignment?: boolean;
  alignment?: Alignment;
}

export interface Alignment {
  horizontal?: 'left' | 'center' | 'right' | 'justify' | 'distributed';
  vertical?: 'top' | 'center' | 'bottom' | 'justify' | 'distributed';
  wrapText?: boolean;
  textRotation?: number;
  indent?: number;
}
```

---

**1.1.2 –û–±–Ω–æ–≤–∏—Ç—å parseStyles() –≤ read_xlsx.ts**

**–§–∞–π–ª:** `src/core-ts/read_xlsx.ts`

**–¢–µ–∫—É—â–∏–π –∫–æ–¥ (—Å—Ç—Ä–æ–∫–∏ 98-136):**
```typescript
function parseStyles(data: Uint8Array): { numFmts: Map<number, string>; styles: CellXfsStyle[] } {
  // ... —Ç–æ–ª—å–∫–æ numFmts –∏ –±–∞–∑–æ–≤—ã–π cellXfs
}
```

**–ó–ê–ú–ï–ù–ò–¢–¨ –ù–ê:**

```typescript
function parseStyles(data: Uint8Array): {
  numFmts: Map<number, string>;
  fonts: Font[];
  fills: Fill[];
  borders: Border[];
  cellXfs: CellXf[];
} {
  const numFmts = new Map<number, string>();
  const fonts: Font[] = [];
  const fills: Fill[] = [];
  const borders: Border[] = [];
  const cellXfs: CellXf[] = [];

  const parser = new XmlSaxParser();

  let inNumFmts = false;
  let inFonts = false;
  let inFills = false;
  let inBorders = false;
  let inCellXfs = false;

  let currentFont: Partial<Font> | null = null;
  let currentFill: Partial<Fill> | null = null;
  let currentBorder: Partial<Border> | null = null;
  let currentCellXf: Partial<CellXf> | null = null;
  let currentAlignment: Partial<Alignment> | null = null;

  // –î–ª—è border edges
  let currentBorderEdge: BorderEdge | null = null;
  let borderEdgeType: 'top' | 'right' | 'bottom' | 'left' | 'diagonal' | null = null;

  parser.parse(data, {
    onStartElement: (name, attrs) => {
      // ===== NUM FMTS =====
      if (name === 'numFmts') {
        inNumFmts = true;
      } else if (name === 'numFmt' && inNumFmts) {
        const id = parseInt(attrs.get('numFmtId') || '0');
        const code = attrs.get('formatCode') || '';
        numFmts.set(id, code);
      }

      // ===== FONTS =====
      else if (name === 'fonts') {
        inFonts = true;
      } else if (name === 'font' && inFonts) {
        currentFont = {
          id: fonts.length,
          name: 'Calibri',
          size: 11,
          bold: false,
          italic: false,
          underline: false,
          strikethrough: false,
          color: 'FF000000'
        };
      } else if (currentFont) {
        if (name === 'name') {
          currentFont.name = attrs.get('val') || 'Calibri';
        } else if (name === 'sz') {
          currentFont.size = parseFloat(attrs.get('val') || '11');
        } else if (name === 'b') {
          currentFont.bold = true;
        } else if (name === 'i') {
          currentFont.italic = true;
        } else if (name === 'u') {
          currentFont.underline = true;
        } else if (name === 'strike') {
          currentFont.strikethrough = true;
        } else if (name === 'color') {
          currentFont.color = attrs.get('rgb') || attrs.get('theme') || 'FF000000';
        }
      }

      // ===== FILLS =====
      else if (name === 'fills') {
        inFills = true;
      } else if (name === 'fill' && inFills) {
        currentFill = {
          id: fills.length,
          patternType: 'none'
        };
      } else if (currentFill && name === 'patternFill') {
        currentFill.patternType = (attrs.get('patternType') || 'none') as any;
      } else if (currentFill && name === 'fgColor') {
        currentFill.fgColor = attrs.get('rgb') || attrs.get('theme');
      } else if (currentFill && name === 'bgColor') {
        currentFill.bgColor = attrs.get('rgb') || attrs.get('theme');
      }

      // ===== BORDERS =====
      else if (name === 'borders') {
        inBorders = true;
      } else if (name === 'border' && inBorders) {
        currentBorder = {
          id: borders.length
        };
      } else if (currentBorder && ['left', 'right', 'top', 'bottom', 'diagonal'].includes(name)) {
        borderEdgeType = name as any;
        const style = attrs.get('style');
        if (style) {
          currentBorderEdge = { style: style as any };
        }
      } else if (currentBorderEdge && name === 'color') {
        currentBorderEdge.color = attrs.get('rgb') || attrs.get('theme');
      }

      // ===== CELLXFS =====
      else if (name === 'cellXfs') {
        inCellXfs = true;
      } else if (name === 'xf' && inCellXfs) {
        currentCellXf = {
          id: cellXfs.length,
          numFmtId: attrs.has('numFmtId') ? parseInt(attrs.get('numFmtId')!) : undefined,
          fontId: attrs.has('fontId') ? parseInt(attrs.get('fontId')!) : undefined,
          fillId: attrs.has('fillId') ? parseInt(attrs.get('fillId')!) : undefined,
          borderId: attrs.has('borderId') ? parseInt(attrs.get('borderId')!) : undefined,
          xfId: attrs.has('xfId') ? parseInt(attrs.get('xfId')!) : undefined,
          applyFont: attrs.get('applyFont') === '1',
          applyFill: attrs.get('applyFill') === '1',
          applyBorder: attrs.get('applyBorder') === '1',
          applyAlignment: attrs.get('applyAlignment') === '1',
        };
      } else if (currentCellXf && name === 'alignment') {
        currentAlignment = {
          horizontal: attrs.get('horizontal') as any,
          vertical: attrs.get('vertical') as any,
          wrapText: attrs.get('wrapText') === '1',
          textRotation: attrs.has('textRotation') ? parseInt(attrs.get('textRotation')!) : undefined,
          indent: attrs.has('indent') ? parseInt(attrs.get('indent')!) : undefined,
        };
      }
    },

    onEndElement: (name) => {
      if (name === 'numFmts') {
        inNumFmts = false;
      } else if (name === 'fonts') {
        inFonts = false;
      } else if (name === 'font' && currentFont) {
        fonts.push(currentFont as Font);
        currentFont = null;
      } else if (name === 'fills') {
        inFills = false;
      } else if (name === 'fill' && currentFill) {
        fills.push(currentFill as Fill);
        currentFill = null;
      } else if (name === 'borders') {
        inBorders = false;
      } else if (name === 'border' && currentBorder) {
        borders.push(currentBorder as Border);
        currentBorder = null;
      } else if (['left', 'right', 'top', 'bottom', 'diagonal'].includes(name) && currentBorderEdge && borderEdgeType) {
        if (currentBorder) {
          currentBorder[borderEdgeType] = currentBorderEdge;
        }
        currentBorderEdge = null;
        borderEdgeType = null;
      } else if (name === 'cellXfs') {
        inCellXfs = false;
      } else if (name === 'alignment' && currentAlignment && currentCellXf) {
        currentCellXf.alignment = currentAlignment as Alignment;
        currentAlignment = null;
      } else if (name === 'xf' && currentCellXf) {
        cellXfs.push(currentCellXf as CellXf);
        currentCellXf = null;
      }
    },
  });

  return { numFmts, fonts, fills, borders, cellXfs };
}
```

---

**1.1.3 –û–±–Ω–æ–≤–∏—Ç—å readXlsxToModel() –¥–ª—è —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è —Å—Ç–∏–ª–µ–π**

**–§–∞–π–ª:** `src/core-ts/read_xlsx.ts` (—Å—Ç—Ä–æ–∫–∏ 5-65)

**–ò–ó–ú–ï–ù–ò–¢–¨:**

```typescript
export async function readXlsxToModel(buffer: ArrayBuffer): Promise<WorkbookModel> {
  const zip = new ZipReader(buffer);
  const entries = await zip.readEntries();

  const model: WorkbookModel = {
    id: crypto.randomUUID(),
    sheets: [],
    sharedStrings: [],
    numFmts: new Map(),
    styles: [],
    definedNames: [],
    fonts: [],        // –ù–û–í–û–ï
    fills: [],        // –ù–û–í–û–ï
    borders: [],      // –ù–û–í–û–ï
    cellXfs: [],      // –ù–û–í–û–ï
  };

  // 1. Parse sharedStrings
  const sstData = entries.get('xl/sharedStrings.xml');
  if (sstData) {
    model.sharedStrings = parseSharedStrings(sstData);
  }

  // 2. Parse styles
  const stylesData = entries.get('xl/styles.xml');
  if (stylesData) {
    const { numFmts, fonts, fills, borders, cellXfs } = parseStyles(stylesData);
    model.numFmts = numFmts;
    model.fonts = fonts;       // –ù–û–í–û–ï
    model.fills = fills;       // –ù–û–í–û–ï
    model.borders = borders;   // –ù–û–í–û–ï
    model.cellXfs = cellXfs;   // –ù–û–í–û–ï

    // –°–æ—Ö—Ä–∞–Ω–∏—Ç—å —Å—Ç–∞—Ä—ã–π —Ñ–æ—Ä–º–∞—Ç –¥–ª—è –æ–±—Ä–∞—Ç–Ω–æ–π —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç–∏
    model.styles = cellXfs.map(xf => ({
      numFmtId: xf.numFmtId,
      fontId: xf.fontId,
      fillId: xf.fillId,
      borderId: xf.borderId,
      xfId: xf.xfId,
    }));
  }

  // 3. Parse workbook...
  // ... –æ—Å—Ç–∞–ª—å–Ω–æ–π –∫–æ–¥ –±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏–π
}
```

---

**1.1.4 –°–æ–∑–¥–∞—Ç—å —É—Ç–∏–ª–∏—Ç—É –¥–ª—è —Ä–∞–∑—Ä–µ—à–µ–Ω–∏—è —Å—Ç–∏–ª–µ–π**

**–§–∞–π–ª:** `src/core-ts/style-resolver.ts` (–ù–û–í–´–ô)

```typescript
import type { WorkbookModel, CellData, Font, Fill, Border, CellXf } from './types';
import type { CellStyle } from './style-types';

/**
 * –†–∞–∑—Ä–µ—à–∞–µ—Ç –ø–æ–ª–Ω—ã–π —Å—Ç–∏–ª—å —è—á–µ–π–∫–∏ –∏–∑ styleId
 */
export function resolveCellStyle(
  cell: CellData,
  workbook: WorkbookModel
): CellStyle | undefined {
  if (cell.styleId === undefined) return undefined;

  const cellXf = workbook.cellXfs?.[cell.styleId];
  if (!cellXf) return undefined;

  const style: CellStyle = {};

  // FONT
  if (cellXf.fontId !== undefined && cellXf.applyFont) {
    const font = workbook.fonts?.[cellXf.fontId];
    if (font) {
      style.fontName = font.name;
      style.fontSize = font.size;
      style.fontBold = font.bold;
      style.fontItalic = font.italic;
      style.fontUnderline = font.underline;
      style.fontStrikethrough = font.strikethrough;
      style.fontColor = argbToHex(font.color);
    }
  }

  // FILL
  if (cellXf.fillId !== undefined && cellXf.applyFill) {
    const fill = workbook.fills?.[cellXf.fillId];
    if (fill && fill.patternType === 'solid' && fill.fgColor) {
      style.backgroundColor = argbToHex(fill.fgColor);
    }
  }

  // BORDER
  if (cellXf.borderId !== undefined && cellXf.applyBorder) {
    const border = workbook.borders?.[cellXf.borderId];
    if (border) {
      if (border.top) {
        style.borderTop = {
          style: border.top.style,
          color: border.top.color ? argbToHex(border.top.color) : undefined,
        };
      }
      if (border.right) {
        style.borderRight = {
          style: border.right.style,
          color: border.right.color ? argbToHex(border.right.color) : undefined,
        };
      }
      if (border.bottom) {
        style.borderBottom = {
          style: border.bottom.style,
          color: border.bottom.color ? argbToHex(border.bottom.color) : undefined,
        };
      }
      if (border.left) {
        style.borderLeft = {
          style: border.left.style,
          color: border.left.color ? argbToHex(border.left.color) : undefined,
        };
      }
    }
  }

  // ALIGNMENT
  if (cellXf.alignment && cellXf.applyAlignment) {
    style.horizontalAlign = cellXf.alignment.horizontal;
    style.verticalAlign = cellXf.alignment.vertical;
    style.wrapText = cellXf.alignment.wrapText;
  }

  // NUMBER FORMAT
  if (cellXf.numFmtId !== undefined) {
    const numFmt = workbook.numFmts?.get(cellXf.numFmtId);
    if (numFmt) {
      style.numberFormat = numFmt;
    }
  }

  return style;
}

/**
 * –ö–æ–Ω–≤–µ—Ä—Ç–∏—Ä—É–µ—Ç ARGB –≤ hex (#RRGGBB)
 */
function argbToHex(argb: string): string {
  if (!argb) return '#000000';

  // ARGB format: AARRGGBB (8 hex digits)
  if (argb.length === 8) {
    // –û—Ç–±—Ä–æ—Å–∏—Ç—å –∞–ª—å—Ñ–∞-–∫–∞–Ω–∞–ª (–ø–µ—Ä–≤—ã–µ 2 —Å–∏–º–≤–æ–ª–∞)
    return '#' + argb.substring(2);
  }

  // RGB format: RRGGBB (6 hex digits)
  if (argb.length === 6) {
    return '#' + argb;
  }

  // Theme color or other format - default to black
  return '#000000';
}

/**
 * –ü—Ä–∏–º–µ–Ω—è–µ—Ç —Ä–∞–∑—Ä–µ—à–µ–Ω–Ω—ã–π —Å—Ç–∏–ª—å –∫ —è—á–µ–π–∫–µ
 */
export function applyCellStyle(
  cell: CellData,
  workbook: WorkbookModel
): CellData {
  const style = resolveCellStyle(cell, workbook);
  if (style) {
    return { ...cell, style };
  }
  return cell;
}
```

---

**1.1.5 –û–±–Ω–æ–≤–∏—Ç—å parseSheet() –¥–ª—è –ø—Ä–∏–º–µ–Ω–µ–Ω–∏—è —Å—Ç–∏–ª–µ–π**

**–§–∞–π–ª:** `src/core-ts/read_xlsx.ts`

**–í —Ñ—É–Ω–∫—Ü–∏–∏ parseSheet(), –ø–æ—Å–ª–µ –æ–∫–æ–Ω—á–∞–Ω–∏—è –ø–∞—Ä—Å–∏–Ω–≥–∞ —è—á–µ–π–∫–∏:**

```typescript
onEndElement: (name) => {
  // ... —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–π –∫–æ–¥
  } else if (name === 'c' && currentCell) {
    // –ù–û–í–û–ï: –†–∞–∑—Ä–µ—à–∏—Ç—å —Å—Ç–∏–ª—å –ø—Ä–∏ –¥–æ–±–∞–≤–ª–µ–Ω–∏–∏ —è—á–µ–π–∫–∏
    const cellData = currentCell as CellData;

    // –ï—Å–ª–∏ –µ—Å—Ç—å styleId, —Å–æ—Ö—Ä–∞–Ω–∏–º –µ–≥–æ –¥–ª—è –ø–æ—Å–ª–µ–¥—É—é—â–µ–≥–æ —Ä–∞–∑—Ä–µ—à–µ–Ω–∏—è
    // –†–∞–∑—Ä–µ—à–µ–Ω–∏–µ —Å—Ç–∏–ª–µ–π –ø—Ä–æ–∏–∑–æ–π–¥–µ—Ç –≤ UI –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞—Ö

    sheet.cells.set(currentCellRef, cellData);
    currentCell = null;
    currentCellRef = '';
  }
}
```

---

**1.1.6 –û–±–Ω–æ–≤–∏—Ç—å EditableCell.tsx –¥–ª—è –ø—Ä–∏–º–µ–Ω–µ–Ω–∏—è —Å—Ç–∏–ª–µ–π**

**–§–∞–π–ª:** `src/components/EditableCell.tsx`

**–ù–∞–π—Ç–∏ —Ñ—É–Ω–∫—Ü–∏—é getCellStyle() –∏ –ó–ê–ú–ï–ù–ò–¢–¨:**

```typescript
import { resolveCellStyle } from '../core-ts/style-resolver';
import { styleToCss } from '../core-ts/style-types';

const getCellStyle = useCallback((cell: CellData): React.CSSProperties => {
  const baseStyle: React.CSSProperties = {
    padding: '4px 8px',
    border: '1px solid #e5e7eb',
    overflow: 'hidden',
    textOverflow: 'ellipsis',
    whiteSpace: 'nowrap',
    backgroundColor: 'white',
  };

  // –ù–û–í–û–ï: –†–∞–∑—Ä–µ—à–∏—Ç—å –ø–æ–ª–Ω—ã–π —Å—Ç–∏–ª—å –∏–∑ workbook
  if (cell.styleId !== undefined && workbook) {
    const cellStyle = resolveCellStyle(cell, workbook);
    if (cellStyle) {
      const cssStyle = styleToCss(cellStyle);
      return { ...baseStyle, ...cssStyle };
    }
  }

  return baseStyle;
}, [workbook]);
```

---

**1.1.7 –ö—Ä–∏—Ç–µ—Ä–∏–∏ –ø—Ä–∏–µ–º–∫–∏ –≠—Ç–∞–ø–∞ 1.1:**

- [ ] –ü—Ä–∏ –∏–º–ø–æ—Ä—Ç–µ Excel —Ñ–∞–π–ª–∞ –≤—Å–µ —à—Ä–∏—Ñ—Ç—ã –æ—Ç–æ–±—Ä–∞–∂–∞—é—Ç—Å—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ (–∏–º—è, —Ä–∞–∑–º–µ—Ä, –∂–∏—Ä–Ω–æ—Å—Ç—å, –∫—É—Ä—Å–∏–≤)
- [ ] –¶–≤–µ—Ç–∞ —Ç–µ–∫—Å—Ç–∞ –ø—Ä–∏–º–µ–Ω—è—é—Ç—Å—è –ø—Ä–∞–≤–∏–ª—å–Ω–æ
- [ ] –¶–≤–µ—Ç–∞ —Ñ–æ–Ω–∞ —è—á–µ–µ–∫ –æ—Ç–æ–±—Ä–∞–∂–∞—é—Ç—Å—è
- [ ] –ì—Ä–∞–Ω–∏—Ü—ã —è—á–µ–µ–∫ –≤–∏–¥–Ω—ã (–≤—Å–µ 4 —Å—Ç–æ—Ä–æ–Ω—ã)
- [ ] –í—ã—Ä–∞–≤–Ω–∏–≤–∞–Ω–∏–µ —Ç–µ–∫—Å—Ç–∞ —Ä–∞–±–æ—Ç–∞–µ—Ç (left, center, right, top, middle, bottom)
- [ ] –ü–µ—Ä–µ–Ω–æ—Å —Ç–µ–∫—Å—Ç–∞ (wrap text) —Ä–∞–±–æ—Ç–∞–µ—Ç
- [ ] –¢–µ—Å—Ç–æ–≤—ã–π —Ñ–∞–π–ª —Å —Ä–∞–∑–Ω–æ–æ–±—Ä–∞–∑–Ω—ã–º–∏ —Å—Ç–∏–ª—è–º–∏ –≤—ã–≥–ª—è–¥–∏—Ç –∏–¥–µ–Ω—Ç–∏—á–Ω–æ Excel

---

### **–≠—Ç–∞–ø 1.2: –£–ª—É—á—à–µ–Ω–∏–µ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è Merged Cells** (0.5 –¥–Ω—è)

**–¢–µ–∫—É—â–µ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ:** Merged ranges –ø–∞—Ä—Å—è—Ç—Å—è, –Ω–æ –≤–∏–∑—É–∞–ª—å–Ω–æ –º–æ–≥—É—Ç –æ—Ç–æ–±—Ä–∞–∂–∞—Ç—å—Å—è –Ω–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ.

**–§–∞–π–ª:** `src/components/EditableGridView.tsx`

#### –ó–∞–¥–∞—á–∏:

**1.2.1 –£–ª—É—á—à–∏—Ç—å –ª–æ–≥–∏–∫—É —Ä–µ–Ω–¥–µ—Ä–∏–Ω–≥–∞ merged cells**

–£–±–µ–¥–∏—Ç—å—Å—è, —á—Ç–æ:
- –¢–æ–ª—å–∫–æ –ø–µ—Ä–≤–∞—è —è—á–µ–π–∫–∞ –≤ merged range –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç –∫–æ–Ω—Ç–µ–Ω—Ç
- –û—Å—Ç–∞–ª—å–Ω—ã–µ —è—á–µ–π–∫–∏ –≤ range —Å–∫—Ä—ã—Ç—ã –∏–ª–∏ –ø—É—Å—Ç—ã–µ
- –°—Ç–∏–ª–∏ –ø—Ä–∏–º–µ–Ω—è—é—Ç—Å—è –∫ merged –æ–±–ª–∞—Å—Ç–∏

**–ö—Ä–∏—Ç–µ—Ä–∏–∏ –ø—Ä–∏–µ–º–∫–∏:**
- [ ] Merged cells –≤–∏–∑—É–∞–ª—å–Ω–æ –∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã (–∫–æ–Ω—Ç–µ–Ω—Ç –≤ –ø–µ—Ä–≤–æ–π —è—á–µ–π–∫–µ)
- [ ] –í—ã—Ä–∞–≤–Ω–∏–≤–∞–Ω–∏–µ –≤ merged cells —Ä–∞–±–æ—Ç–∞–µ—Ç
- [ ] –°—Ç–∏–ª–∏ –ø—Ä–∏–º–µ–Ω—è—é—Ç—Å—è –∫–æ –≤—Å–µ–π merged –æ–±–ª–∞—Å—Ç–∏

---

### **–≠—Ç–∞–ø 1.3: –ü–æ–ª–Ω–∞—è –ø–æ–¥–¥–µ—Ä–∂–∫–∞ —Ñ–æ—Ä–º—É–ª** (1 –¥–µ–Ω—å)

#### –ó–∞–¥–∞—á–∏:

**1.3.1 –û–±–Ω–æ–≤–∏—Ç—å parseSheet() –¥–ª—è —á—Ç–µ–Ω–∏—è —Ñ–æ—Ä–º—É–ª**

**–§–∞–π–ª:** `src/core-ts/read_xlsx.ts`

**–ó–ê–ú–ï–ù–ò–¢–¨:**

```typescript
function parseSheet(data: Uint8Array, id: string, name: string, sheetId: number, sharedStrings: string[]): SheetModel {
  // ... —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–π –∫–æ–¥

  let inFormula = false;
  let formulaType: string | null = null;
  let formulaRef: string | null = null;
  let formulaSi: string | null = null;

  parser.parse(data, {
    onStartElement: (name, attrs) => {
      // ... —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–π –∫–æ–¥ –¥–ª—è –¥—Ä—É–≥–∏—Ö —ç–ª–µ–º–µ–Ω—Ç–æ–≤

      } else if (name === 'f' && currentCell) {
        inFormula = true;
        formulaType = attrs.get('t') || null;        // shared, array, normal
        formulaRef = attrs.get('ref') || null;       // –¥–ª—è array/shared
        formulaSi = attrs.get('si') || null;         // shared index
        currentCell.formula = '';  // –ë—É–¥–µ—Ç –∑–∞–ø–æ–ª–Ω–µ–Ω–æ –≤ onText
      }
    },

    onText: (text) => {
      if (inFormula && currentCell) {
        currentCell.formula = (currentCell.formula || '') + text;
      } else if (currentCell) {
        // ... —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–π –∫–æ–¥ –¥–ª—è value
      }
    },

    onEndElement: (name) => {
      if (name === 'f') {
        inFormula = false;
        // –°–æ—Ö—Ä–∞–Ω–∏—Ç—å –º–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ —Ñ–æ—Ä–º—É–ª—ã –µ—Å–ª–∏ –Ω—É–∂–Ω–æ
        if (currentCell && formulaType) {
          // –ú–æ–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å –≤ CellData –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –ø–æ–ª—è:
          // currentCell.formulaType = formulaType;
          // currentCell.formulaRef = formulaRef;
          // currentCell.formulaSi = formulaSi;
        }
        formulaType = null;
        formulaRef = null;
        formulaSi = null;
      }
      // ... –æ—Å—Ç–∞–ª—å–Ω–æ–π –∫–æ–¥
    }
  });
}
```

**1.3.2 –û–±–Ω–æ–≤–∏—Ç—å FormulaBar –¥–ª—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è —Ñ–æ—Ä–º—É–ª**

**–§–∞–π–ª:** `src/components/FormulaBar.tsx`

–£–±–µ–¥–∏—Ç—å—Å—è, —á—Ç–æ formula bar –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç `cell.formula` –µ—Å–ª–∏ –æ–Ω–∞ –µ—Å—Ç—å.

**–ö—Ä–∏—Ç–µ—Ä–∏–∏ –ø—Ä–∏–µ–º–∫–∏:**
- [ ] –§–æ—Ä–º—É–ª—ã —á–∏—Ç–∞—é—Ç—Å—è –∏–∑ Excel —Ñ–∞–π–ª–∞
- [ ] –§–æ—Ä–º—É–ª—ã –æ—Ç–æ–±—Ä–∞–∂–∞—é—Ç—Å—è –≤ formula bar
- [ ] –ü—Ä–∏ —ç–∫—Å–ø–æ—Ä—Ç–µ —Ñ–æ—Ä–º—É–ª—ã —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è

---

### **–≠—Ç–∞–ø 1.4: –ü–æ–ª–Ω–∞—è –ø–æ–¥–¥–µ—Ä–∂–∫–∞ Number Formats** (1 –¥–µ–Ω—å)

#### –ó–∞–¥–∞—á–∏:

**1.4.1 –°–æ–∑–¥–∞—Ç—å –ø–æ–ª–Ω—ã–π –ø–∞—Ä—Å–µ—Ä Excel number formats**

**–§–∞–π–ª:** `src/utils/number-format.ts` (–æ–±–Ω–æ–≤–∏—Ç—å —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–π)

**–î–æ–±–∞–≤–∏—Ç—å –ø–æ–¥–¥–µ—Ä–∂–∫—É:**
- –í—Å—Ç—Ä–æ–µ–Ω–Ω—ã–µ —Ñ–æ—Ä–º–∞—Ç—ã (0-49)
- –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–µ —Ñ–æ—Ä–º–∞—Ç—ã
- –í–∞–ª—é—Ç–∞ (currency)
- –ü—Ä–æ—Ü–µ–Ω—Ç—ã
- –î–∞—Ç—ã –∏ –≤—Ä–µ–º—è (–≤—Å–µ –≤–∞—Ä–∏–∞–Ω—Ç—ã)
- –ù–∞—É—á–Ω–∞—è –Ω–æ—Ç–∞—Ü–∏—è
- –î—Ä–æ–±–∏

**1.4.2 –ü—Ä–∏–º–µ–Ω–∏—Ç—å —Ñ–æ—Ä–º–∞—Ç—ã –≤ UI**

–í `EditableCell.tsx` –ø—Ä–∏ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–∏ –∑–Ω–∞—á–µ–Ω–∏—è:

```typescript
import { formatCellValue } from '../utils/number-format';

const displayValue = useMemo(() => {
  if (!cell) return '';

  // –ï—Å–ª–∏ –µ—Å—Ç—å —Ñ–æ—Ä–º—É–ª–∞ –∏ —Ä–µ–∑—É–ª—å—Ç–∞—Ç, –ø–æ–∫–∞–∑–∞—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç
  if (cell.formula && cell.value !== null) {
    return formatCellValue(cell.value, cell.style?.numberFormat);
  }

  // –ò–Ω–∞—á–µ –ø–æ–∫–∞–∑–∞—Ç—å –∑–Ω–∞—á–µ–Ω–∏–µ
  return formatCellValue(cell.value, cell.style?.numberFormat);
}, [cell]);
```

**–ö—Ä–∏—Ç–µ—Ä–∏–∏ –ø—Ä–∏–µ–º–∫–∏:**
- [ ] –í—Å–µ –≤—Å—Ç—Ä–æ–µ–Ω–Ω—ã–µ —Ñ–æ—Ä–º–∞—Ç—ã —Ä–∞–±–æ—Ç–∞—é—Ç
- [ ] –î–∞—Ç—ã –æ—Ç–æ–±—Ä–∞–∂–∞—é—Ç—Å—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ
- [ ] –í–∞–ª—é—Ç–∞ —Å —Å–∏–º–≤–æ–ª–∞–º–∏ ($, ‚Ç¨, ‚ÇΩ)
- [ ] –ü—Ä–æ—Ü–µ–Ω—Ç—ã
- [ ] –ß–∏—Å–ª–∞ —Å —Ä–∞–∑–¥–µ–ª–∏—Ç–µ–ª—è–º–∏ —Ç—ã—Å—è—á

---

## üé® –§–ê–ó–ê 2: –í–∞–∂–Ω—ã–µ –≤–∏–∑—É–∞–ª—å–Ω—ã–µ —Ñ–∏—á–∏

**–¶–µ–ª—å:** –° 75% –¥–æ 85% –∏–¥–µ–Ω—Ç–∏—á–Ω–æ—Å—Ç–∏
**–í—Ä–µ–º—è:** 3-4 –¥–Ω—è
**–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç:** üü† –í—ã—Å–æ–∫–∏–π

---

### **–≠—Ç–∞–ø 2.1: –£—Å–ª–æ–≤–Ω–æ–µ —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ** (2 –¥–Ω—è)

#### –ó–∞–¥–∞—á–∏:

**2.1.1 –î–æ–±–∞–≤–∏—Ç—å —Ç–∏–ø—ã –¥–ª—è —É—Å–ª–æ–≤–Ω–æ–≥–æ —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏—è**

**–§–∞–π–ª:** `src/core-ts/types.ts`

```typescript
export interface SheetModel {
  // ... —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–µ –ø–æ–ª—è
  conditionalFormatting?: ConditionalFormattingRule[];  // –ù–û–í–û–ï
}

export interface ConditionalFormattingRule {
  sqref: string;  // "A1:A10"
  type: 'dataBar' | 'colorScale' | 'iconSet' | 'cellIs' | 'expression';
  priority: number;

  // –î–ª—è dataBar
  dataBar?: {
    minType: 'min' | 'num' | 'percent' | 'percentile' | 'formula';
    maxType: 'max' | 'num' | 'percent' | 'percentile' | 'formula';
    minValue?: number;
    maxValue?: number;
    color: string;  // RGB
    showValue?: boolean;
  };

  // –î–ª—è colorScale
  colorScale?: {
    cfvo: Array<{ type: 'min' | 'max' | 'num' | 'percent' | 'percentile', val?: number }>;
    colors: string[];  // RGB –º–∞—Å—Å–∏–≤
  };

  // –î–ª—è iconSet
  iconSet?: {
    iconSetType: '3Arrows' | '3TrafficLights1' | '3Flags' | '4Rating' | '5Quarters';
    cfvo: Array<{ type: 'percent' | 'num' | 'formula', val?: number }>;
    reverse?: boolean;
    showValue?: boolean;
  };

  // –î–ª—è cellIs
  cellIs?: {
    operator: 'greaterThan' | 'lessThan' | 'between' | 'equal' | 'notEqual';
    formula: string[];
    dxfId?: number;  // Differential format
  };

  // –î–ª—è expression
  expression?: {
    formula: string;
    dxfId?: number;
  };
}
```

**2.1.2 –ü–∞—Ä—Å–∏—Ç—å —É—Å–ª–æ–≤–Ω–æ–µ —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –≤ parseSheet()**

**–§–∞–π–ª:** `src/core-ts/read_xlsx.ts`

```typescript
function parseSheet(...) {
  // ... —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–π –∫–æ–¥

  const conditionalFormatting: ConditionalFormattingRule[] = [];
  let inConditionalFormatting = false;
  let currentCfRule: Partial<ConditionalFormattingRule> | null = null;
  let cfSqref: string = '';

  parser.parse(data, {
    onStartElement: (name, attrs) => {
      // ... —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–π –∫–æ–¥

      if (name === 'conditionalFormatting') {
        inConditionalFormatting = true;
        cfSqref = attrs.get('sqref') || '';
      } else if (name === 'cfRule' && inConditionalFormatting) {
        const type = attrs.get('type') || 'cellIs';
        const priority = parseInt(attrs.get('priority') || '1');

        currentCfRule = {
          sqref: cfSqref,
          type: type as any,
          priority,
        };

        // –ü–∞—Ä—Å–∏—Ç—å —Å–ø–µ—Ü–∏—Ñ–∏—á–Ω—ã–µ –∞—Ç—Ä–∏–±—É—Ç—ã –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç type
        // ... (–¥–µ—Ç–∞–ª–∏ –≤ –∫–æ–¥–µ)
      } else if (currentCfRule) {
        // –ü–∞—Ä—Å–∏—Ç—å –¥–æ—á–µ—Ä–Ω–∏–µ —ç–ª–µ–º–µ–Ω—Ç—ã: dataBar, colorScale, iconSet –∏ —Ç.–¥.
        // ... (–¥–µ—Ç–∞–ª–∏ –≤ –∫–æ–¥–µ)
      }
    },

    onEndElement: (name) => {
      if (name === 'conditionalFormatting') {
        inConditionalFormatting = false;
      } else if (name === 'cfRule' && currentCfRule) {
        conditionalFormatting.push(currentCfRule as ConditionalFormattingRule);
        currentCfRule = null;
      }
    }
  });

  sheet.conditionalFormatting = conditionalFormatting;
  return sheet;
}
```

**2.1.3 –ü—Ä–∏–º–µ–Ω–∏—Ç—å —É—Å–ª–æ–≤–Ω–æ–µ —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –≤ UI**

**–§–∞–π–ª:** `src/components/EditableCell.tsx`

```typescript
// –§—É–Ω–∫—Ü–∏—è –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏, –ø–æ–ø–∞–¥–∞–µ—Ç –ª–∏ —è—á–µ–π–∫–∞ –≤ —É—Å–ª–æ–≤–Ω–æ–µ —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ
const getConditionalFormat = useCallback((cell: CellData, sheet: SheetModel) => {
  if (!sheet.conditionalFormatting) return null;

  const cellRef = `${colNumberToLetter(cell.col - 1)}${cell.row}`;

  for (const rule of sheet.conditionalFormatting) {
    if (cellInRange(cellRef, rule.sqref)) {
      // –í—ã—á–∏—Å–ª–∏—Ç—å, –ø—Ä–∏–º–µ–Ω—è–µ—Ç—Å—è –ª–∏ –ø—Ä–∞–≤–∏–ª–æ –∫ —ç—Ç–æ–π —è—á–µ–π–∫–µ
      // –í–µ—Ä–Ω—É—Ç—å —Å—Ç–∏–ª—å –¥–ª—è –ø—Ä–∏–º–µ–Ω–µ–Ω–∏—è
      return calculateConditionalStyle(rule, cell, sheet);
    }
  }

  return null;
}, []);

// –í —Ä–µ–Ω–¥–µ—Ä–µ:
const conditionalStyle = getConditionalFormat(cell, sheet);
const finalStyle = { ...baseStyle, ...cellStyle, ...conditionalStyle };
```

**–ö—Ä–∏—Ç–µ—Ä–∏–∏ –ø—Ä–∏–µ–º–∫–∏:**
- [ ] Data bars –æ—Ç–æ–±—Ä–∞–∂–∞—é—Ç—Å—è –≤ —è—á–µ–π–∫–∞—Ö
- [ ] Color scales (–≥—Ä–∞–¥–∏–µ–Ω—Ç—ã) —Ä–∞–±–æ—Ç–∞—é—Ç
- [ ] Icon sets (–∏–∫–æ–Ω–∫–∏) –æ—Ç–æ–±—Ä–∞–∂–∞—é—Ç—Å—è
- [ ] cellIs rules (–ø–æ–¥—Å–≤–µ—Ç–∫–∞ –ø–æ —É—Å–ª–æ–≤–∏—é) —Ä–∞–±–æ—Ç–∞—é—Ç

---

### **–≠—Ç–∞–ø 2.2: Data Validation** (1 –¥–µ–Ω—å)

#### –ó–∞–¥–∞—á–∏:

**2.2.1 –î–æ–±–∞–≤–∏—Ç—å —Ç–∏–ø—ã**

**–§–∞–π–ª:** `src/core-ts/types.ts`

```typescript
export interface SheetModel {
  // ... —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–µ –ø–æ–ª—è
  dataValidations?: DataValidation[];  // –ù–û–í–û–ï
}

export interface DataValidation {
  sqref: string;  // "A1:A10"
  type: 'list' | 'whole' | 'decimal' | 'date' | 'time' | 'textLength' | 'custom';
  operator?: 'between' | 'notBetween' | 'equal' | 'notEqual' | 'greaterThan' | 'lessThan' | 'greaterThanOrEqual' | 'lessThanOrEqual';
  formula1?: string;
  formula2?: string;
  allowBlank?: boolean;
  showDropDown?: boolean;
  showInputMessage?: boolean;
  showErrorMessage?: boolean;
  errorTitle?: string;
  error?: string;
  promptTitle?: string;
  prompt?: string;
  errorStyle?: 'stop' | 'warning' | 'information';
}
```

**2.2.2 –ü–∞—Ä—Å–∏—Ç—å –≤ parseSheet()**

**–§–∞–π–ª:** `src/core-ts/read_xlsx.ts`

```typescript
// –ê–Ω–∞–ª–æ–≥–∏—á–Ω–æ —É—Å–ª–æ–≤–Ω–æ–º—É —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏—é
if (name === 'dataValidations') { ... }
else if (name === 'dataValidation') { ... }
```

**2.2.3 UI: Dropdown –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä**

**–§–∞–π–ª:** `src/components/EditableCell.tsx`

–î–æ–±–∞–≤–∏—Ç—å —Å—Ç—Ä–µ–ª–∫—É dropdown –¥–ª—è —è—á–µ–µ–∫ —Å validation type="list".

**–ö—Ä–∏—Ç–µ—Ä–∏–∏ –ø—Ä–∏–µ–º–∫–∏:**
- [ ] Dropdown —Å—Ç—Ä–µ–ª–∫–∞ –≤–∏–¥–Ω–∞ –≤ —è—á–µ–π–∫–∞—Ö —Å list validation
- [ ] –ü—Ä–∏ –∫–ª–∏–∫–µ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è —Å–ø–∏—Å–æ–∫ –æ–ø—Ü–∏–π
- [ ] –í–∞–ª–∏–¥–∞—Ü–∏—è –ø—Ä–∏ –≤–≤–æ–¥–µ —Ä–∞–±–æ—Ç–∞–µ—Ç

---

### **–≠—Ç–∞–ø 2.3: –ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏** (1 –¥–µ–Ω—å)

#### –ó–∞–¥–∞—á–∏:

**2.3.1 –ü–∞—Ä—Å–∏—Ç—å xl/comments1.xml**

**–§–∞–π–ª:** `src/core-ts/read_xlsx.ts`

```typescript
// –í readXlsxToModel():
// –î–ª—è –∫–∞–∂–¥–æ–≥–æ –ª–∏—Å—Ç–∞ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å –Ω–∞–ª–∏—á–∏–µ comments
const commentsData = entries.get(`xl/comments${sheetInfo.sheetId}.xml`);
if (commentsData) {
  sheet.comments = parseComments(commentsData);
}

function parseComments(data: Uint8Array): Map<string, Comment> {
  const comments = new Map<string, Comment>();
  // ... –ø–∞—Ä—Å–∏–Ω–≥ XML
  return comments;
}
```

**2.3.2 UI: –ò–Ω–¥–∏–∫–∞—Ç–æ—Ä –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏—è**

**–§–∞–π–ª:** `src/components/EditableCell.tsx`

–î–æ–±–∞–≤–∏—Ç—å –∫—Ä–∞—Å–Ω—ã–π —Ç—Ä–µ—É–≥–æ–ª—å–Ω–∏–∫ –≤ –ø—Ä–∞–≤–æ–º –≤–µ—Ä—Ö–Ω–µ–º —É–≥–ª—É —è—á–µ–π–∫–∏ —Å –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–µ–º.

**–ö—Ä–∏—Ç–µ—Ä–∏–∏ –ø—Ä–∏–µ–º–∫–∏:**
- [ ] –ö—Ä–∞—Å–Ω—ã–π —Ç—Ä–µ—É–≥–æ–ª—å–Ω–∏–∫ –≤–∏–¥–µ–Ω –≤ —è—á–µ–π–∫–∞—Ö —Å –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏—è–º–∏
- [ ] –ü—Ä–∏ –Ω–∞–≤–µ–¥–µ–Ω–∏–∏/–∫–ª–∏–∫–µ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è —Ç–µ–∫—Å—Ç –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏—è
- [ ] –ê–≤—Ç–æ—Ä –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏—è –≤–∏–¥–µ–Ω

---

## üñºÔ∏è –§–ê–ó–ê 3: –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —ç–ª–µ–º–µ–Ω—Ç—ã

**–¶–µ–ª—å:** –° 85% –¥–æ 95% –∏–¥–µ–Ω—Ç–∏—á–Ω–æ—Å—Ç–∏
**–í—Ä–µ–º—è:** 5-8 –¥–Ω–µ–π
**–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç:** üü° –°—Ä–µ–¥–Ω–∏–π

---

### **–≠—Ç–∞–ø 3.1: –ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è** (2-3 –¥–Ω—è)

#### –ó–∞–¥–∞—á–∏:

**3.1.1 –ü–∞—Ä—Å–∏—Ç—å xl/drawings/drawing1.xml**

–ò–∑–≤–ª–µ—á—å –ø–æ–∑–∏—Ü–∏–∏ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π (from, to –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç—ã).

**3.1.2 –ß–∏—Ç–∞—Ç—å xl/media/image1.png**

–ò–∑–≤–ª–µ—á—å –±–∏–Ω–∞—Ä–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π –∏–∑ ZIP.

**3.1.3 –û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –≤ UI**

–†–∞–∑–º–µ—Å—Ç–∏—Ç—å –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è –Ω–∞–¥ grid –≤ –ø—Ä–∞–≤–∏–ª—å–Ω—ã—Ö –ø–æ–∑–∏—Ü–∏—è—Ö.

---

### **–≠—Ç–∞–ø 3.2: –¢–∞–±–ª–∏—Ü—ã (Excel Tables)** (2 –¥–Ω—è)

#### –ó–∞–¥–∞—á–∏:

**3.2.1 –ü–∞—Ä—Å–∏—Ç—å xl/tables/table1.xml**

**3.2.2 –ü—Ä–∏–º–µ–Ω–∏—Ç—å —Å—Ç–∏–ª–∏ —Ç–∞–±–ª–∏—Ü—ã**

**3.2.3 –§–∏–ª—å—Ç—Ä—ã —Ç–∞–±–ª–∏—Ü—ã**

---

### **–≠—Ç–∞–ø 3.3: –î–∏–∞–≥—Ä–∞–º–º—ã** (3-5 –¥–Ω–µ–π)

#### –ó–∞–¥–∞—á–∏:

**3.3.1 –ü–∞—Ä—Å–∏—Ç—å xl/charts/chart1.xml**

**3.3.2 –†–µ–Ω–¥–µ—Ä–∏—Ç—å –¥–∏–∞–≥—Ä–∞–º–º—ã (–∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å recharts –∏–ª–∏ Chart.js)**

---

## ‚úÖ –ö—Ä–∏—Ç–µ—Ä–∏–∏ –ø—Ä–∏–µ–º–∫–∏

### –û–±—â–∏–µ –∫—Ä–∏—Ç–µ—Ä–∏–∏:

- [ ] **–í–∏–∑—É–∞–ª—å–Ω–∞—è –∏–¥–µ–Ω—Ç–∏—á–Ω–æ—Å—Ç—å:** –ò–º–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω–Ω—ã–π —Ñ–∞–π–ª –≤—ã–≥–ª—è–¥–∏—Ç –Ω–∞ 95%+ –∏–¥–µ–Ω—Ç–∏—á–Ω–æ –æ—Ä–∏–≥–∏–Ω–∞–ª—É –≤ Excel
- [ ] **–ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å:** –ò–º–ø–æ—Ä—Ç —Ñ–∞–π–ª–∞ 50MB –∑–∞–≤–µ—Ä—à–∞–µ—Ç—Å—è –∑–∞ <10 —Å–µ–∫—É–Ω–¥
- [ ] **–°—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç—å:** –ù–µ—Ç –∫—Ä–∞—à–µ–π, –∫–æ—Ä—Ä–µ–∫—Ç–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫
- [ ] **–≠–∫—Å–ø–æ—Ä—Ç:** –í—Å–µ –∏–º–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ —ç–∫—Å–ø–æ—Ä—Ç–∏—Ä—É—é—Ç—Å—è –æ–±—Ä–∞—Ç–Ω–æ –≤ Excel –±–µ–∑ –ø–æ—Ç–µ—Ä—å

### –ü–æ–∫—Ä—ã—Ç–∏–µ –ø–æ –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º:

| –ö–∞—Ç–µ–≥–æ—Ä–∏—è | –¶–µ–ª—å | –ö—Ä–∏—Ç–µ—Ä–∏–π |
|-----------|------|----------|
| –°—Ç–∏–ª–∏ | 95% | –®—Ä–∏—Ñ—Ç—ã, —Ü–≤–µ—Ç–∞, –≥—Ä–∞–Ω–∏—Ü—ã, –∑–∞–ª–∏–≤–∫–∏, –≤—ã—Ä–∞–≤–Ω–∏–≤–∞–Ω–∏–µ |
| –§–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ | 90% | Number formats, merged cells, wrap text |
| –§–æ—Ä–º—É–ª—ã | 100% | –í—Å–µ —Ñ–æ—Ä–º—É–ª—ã —Å–æ—Ö—Ä–∞–Ω–µ–Ω—ã –∏ –≤–∏–¥–Ω—ã |
| –£—Å–ª–æ–≤–Ω–æ–µ —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ | 80% | Data bars, color scales, –æ—Å–Ω–æ–≤–Ω—ã–µ –ø—Ä–∞–≤–∏–ª–∞ |
| Data Validation | 70% | Dropdown —Å–ø–∏—Å–∫–∏, –±–∞–∑–æ–≤–∞—è –≤–∞–ª–∏–¥–∞—Ü–∏—è |
| –ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏ | 80% | –ò–Ω–¥–∏–∫–∞—Ç–æ—Ä—ã, —Ç–µ–∫—Å—Ç, –∞–≤—Ç–æ—Ä—ã |
| –ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è | 60% | –û—Å–Ω–æ–≤–Ω—ã–µ —Ñ–æ—Ä–º–∞—Ç—ã (PNG, JPEG) |
| –¢–∞–±–ª–∏—Ü—ã | 50% | –ë–∞–∑–æ–≤—ã–µ —Å—Ç–∏–ª–∏ —Ç–∞–±–ª–∏—Ü |
| –î–∏–∞–≥—Ä–∞–º–º—ã | 40% | –û—Å–Ω–æ–≤–Ω—ã–µ —Ç–∏–ø—ã –¥–∏–∞–≥—Ä–∞–º–º |

---

## üìä –ú–µ—Ç—Ä–∏–∫–∏ —É—Å–ø–µ—Ö–∞

### –ö–æ–ª–∏—á–µ—Å—Ç–≤–µ–Ω–Ω—ã–µ:

- **–í–∏–∑—É–∞–ª—å–Ω–∞—è –∏–¥–µ–Ω—Ç–∏—á–Ω–æ—Å—Ç—å:** 95%+ (–ø–æ —á–µ–∫-–ª–∏—Å—Ç—É –∏–∑ 100 —ç–ª–µ–º–µ–Ω—Ç–æ–≤)
- **–í—Ä–µ–º—è –∏–º–ø–æ—Ä—Ç–∞:** <10 —Å–µ–∫ –¥–ª—è 50MB —Ñ–∞–π–ª–∞
- **–ü–æ–∫—Ä—ã—Ç–∏–µ —Å—Ç–∏–ª–µ–π:** 95%+
- **–ü–æ–∫—Ä—ã—Ç–∏–µ —Ñ–æ—Ä–º—É–ª:** 100%
- **Memory footprint:** <500MB –¥–ª—è —Ç–∏–ø–∏—á–Ω–æ–≥–æ workbook

### –ö–∞—á–µ—Å—Ç–≤–µ–Ω–Ω—ã–µ:

- –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–µ –∑–∞–º–µ—á–∞–µ—Ç —Ä–∞–∑–Ω–∏—Ü—ã –ø—Ä–∏ —Å—Ä–∞–≤–Ω–µ–Ω–∏–∏ —Å Excel (A/B —Ç–µ—Å—Ç)
- –ù–µ—Ç –≤–∏–∑—É–∞–ª—å–Ω—ã—Ö –∞—Ä—Ç–µ—Ñ–∞–∫—Ç–æ–≤
- Smooth UX (60fps scrolling)

---

## üîß –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è

### –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏:

**–ë–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏–π** - –∏—Å–ø–æ–ª—å–∑—É–µ–º —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–π —Å—Ç–µ–∫:
- `ZipReader` (custom)
- `XmlSaxParser` (custom)
- React, TypeScript
- Tauri

### –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å:

- –ü–∞—Ä—Å–∏–Ω–≥ —Å—Ç–∏–ª–µ–π: streaming, –Ω–µ –∑–∞–≥—Ä—É–∂–∞—Ç—å –≤—Å—ë –≤ –ø–∞–º—è—Ç—å
- Lazy loading: —É—Å–ª–æ–≤–Ω–æ–µ —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –≤—ã—á–∏—Å–ª—è–µ—Ç—Å—è —Ç–æ–ª—å–∫–æ –¥–ª—è –≤–∏–¥–∏–º—ã—Ö —è—á–µ–µ–∫
- Memoization: –∫–µ—à–∏—Ä–æ–≤–∞—Ç—å —Ä–∞–∑—Ä–µ—à–µ–Ω–Ω—ã–µ —Å—Ç–∏–ª–∏

### –û–±—Ä–∞—Ç–Ω–∞—è —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å:

- –°—Ç–∞—Ä—ã–µ .kst —Ñ–∞–π–ª—ã –¥–æ–ª–∂–Ω—ã –æ—Ç–∫—Ä—ã–≤–∞—Ç—å—Å—è
- –≠–∫—Å–ø–æ—Ä—Ç –¥–æ–ª–∂–µ–Ω —Å–æ—Ö—Ä–∞–Ω—è—Ç—å –≤—Å–µ –Ω–æ–≤—ã–µ –ø–æ–ª—è

---

## üìù –ü—Ä–∏–ª–æ–∂–µ–Ω–∏—è

### A. –°—Ç—Ä—É–∫—Ç—É—Ä–∞ Excel —Ñ–∞–π–ª–∞ (.xlsx)

```
.xlsx (ZIP archive)
‚îú‚îÄ‚îÄ [Content_Types].xml
‚îú‚îÄ‚îÄ _rels/
‚îÇ   ‚îî‚îÄ‚îÄ .rels
‚îú‚îÄ‚îÄ xl/
‚îÇ   ‚îú‚îÄ‚îÄ workbook.xml           # ‚úÖ –ü–∞—Ä—Å–∏—Ç—Å—è
‚îÇ   ‚îú‚îÄ‚îÄ _rels/
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ workbook.xml.rels  # ‚úÖ –ü–∞—Ä—Å–∏—Ç—Å—è
‚îÇ   ‚îú‚îÄ‚îÄ worksheets/
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ sheet1.xml         # ‚ö†Ô∏è –ü–∞—Ä—Å–∏—Ç—Å—è —á–∞—Å—Ç–∏—á–Ω–æ
‚îÇ   ‚îú‚îÄ‚îÄ sharedStrings.xml      # ‚úÖ –ü–∞—Ä—Å–∏—Ç—Å—è
‚îÇ   ‚îú‚îÄ‚îÄ styles.xml             # ‚ö†Ô∏è –ü–∞—Ä—Å–∏—Ç—Å—è —á–∞—Å—Ç–∏—á–Ω–æ ‚Üí –§–ê–ó–ê 1
‚îÇ   ‚îú‚îÄ‚îÄ comments1.xml          # ‚ùå –ù–µ –ø–∞—Ä—Å–∏—Ç—Å—è ‚Üí –§–ê–ó–ê 2
‚îÇ   ‚îú‚îÄ‚îÄ drawings/
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ drawing1.xml       # ‚ùå –ù–µ –ø–∞—Ä—Å–∏—Ç—Å—è ‚Üí –§–ê–ó–ê 3
‚îÇ   ‚îú‚îÄ‚îÄ tables/
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ table1.xml         # ‚ùå –ù–µ –ø–∞—Ä—Å–∏—Ç—Å—è ‚Üí –§–ê–ó–ê 3
‚îÇ   ‚îú‚îÄ‚îÄ charts/
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ chart1.xml         # ‚ùå –ù–µ –ø–∞—Ä—Å–∏—Ç—Å—è ‚Üí –§–ê–ó–ê 3
‚îÇ   ‚îî‚îÄ‚îÄ media/
‚îÇ       ‚îî‚îÄ‚îÄ image1.png         # ‚ùå –ù–µ –ø–∞—Ä—Å–∏—Ç—Å—è ‚Üí –§–ê–ó–ê 3
```

### B. –ü—Ä–∏–º–µ—Ä –ø–æ–ª–Ω–æ–≥–æ —Å—Ç–∏–ª—è —è—á–µ–π–∫–∏

```xml
<!-- –í xl/styles.xml -->
<fonts count="2">
  <font>  <!-- fontId="0" -->
    <sz val="11"/>
    <color rgb="FF000000"/>
    <name val="Calibri"/>
  </font>
  <font>  <!-- fontId="1" -->
    <sz val="14"/>
    <color rgb="FFFF0000"/>
    <name val="Arial"/>
    <b/>
    <i/>
  </font>
</fonts>

<fills count="2">
  <fill>  <!-- fillId="0" -->
    <patternFill patternType="none"/>
  </fill>
  <fill>  <!-- fillId="1" -->
    <patternFill patternType="solid">
      <fgColor rgb="FFFFFF00"/>
    </patternFill>
  </fill>
</fills>

<borders count="2">
  <border>  <!-- borderId="0" -->
    <left/><right/><top/><bottom/>
  </border>
  <border>  <!-- borderId="1" -->
    <left style="thin"><color rgb="FF000000"/></left>
    <right style="thin"><color rgb="FF000000"/></right>
    <top style="thin"><color rgb="FF000000"/></top>
    <bottom style="thin"><color rgb="FF000000"/></bottom>
  </border>
</borders>

<cellXfs count="2">
  <xf numFmtId="0" fontId="0" fillId="0" borderId="0" xfId="0"/>  <!-- styleId="0" -->
  <xf numFmtId="0" fontId="1" fillId="1" borderId="1" xfId="0" applyFont="1" applyFill="1" applyBorder="1" applyAlignment="1">
    <alignment horizontal="center" vertical="middle" wrapText="1"/>
  </xf>  <!-- styleId="1" -->
</cellXfs>
```

```xml
<!-- –í xl/worksheets/sheet1.xml -->
<c r="A1" s="1">  <!-- styleId="1" -->
  <v>Hello World</v>
</c>
```

**–†–µ–∑—É–ª—å—Ç–∞—Ç:**
- –®—Ä–∏—Ñ—Ç: Arial, 14pt, –∂–∏—Ä–Ω—ã–π, –∫—É—Ä—Å–∏–≤, –∫—Ä–∞—Å–Ω—ã–π
- –§–æ–Ω: –∂–µ–ª—Ç—ã–π
- –ì—Ä–∞–Ω–∏—Ü—ã: —Ç–æ–Ω–∫–∏–µ —á–µ—Ä–Ω—ã–µ —Å–æ –≤—Å–µ—Ö —Å—Ç–æ—Ä–æ–Ω
- –í—ã—Ä–∞–≤–Ω–∏–≤–∞–Ω–∏–µ: –ø–æ —Ü–µ–Ω—Ç—Ä—É, –ø–æ —Å–µ—Ä–µ–¥–∏–Ω–µ
- –ü–µ—Ä–µ–Ω–æ—Å —Ç–µ–∫—Å—Ç–∞: –¥–∞

---

## üéâ –í—ã–ø–æ–ª–Ω–µ–Ω–Ω–∞—è —Ä–∞–±–æ—Ç–∞

### Phase 1: –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –≤–∏–∑—É–∞–ª—å–Ω—ã–µ —ç–ª–µ–º–µ–Ω—Ç—ã ‚úÖ –ó–ê–í–ï–†–®–ï–ù–ê

#### Etap 1.1: –ü–æ–ª–Ω–∞—è –ø–æ–¥–¥–µ—Ä–∂–∫–∞ —Å—Ç–∏–ª–µ–π ‚úÖ
**–î–∞—Ç–∞:** 2025-10-05

**–†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã:**
- ‚úÖ `src/core-ts/types.ts` - –î–æ–±–∞–≤–ª–µ–Ω—ã –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å—ã Font, Fill, Border, BorderEdge, CellXf, Alignment
- ‚úÖ `src/core-ts/read_xlsx.ts` - parseStyles() –ø–æ–ª–Ω–æ—Å—Ç—å—é –ø–µ—Ä–µ–ø–∏—Å–∞–Ω –¥–ª—è –ø–∞—Ä—Å–∏–Ω–≥–∞ fonts, fills, borders, cellXfs
- ‚úÖ `src/core-ts/style-resolver.ts` - –°–æ–∑–¥–∞–Ω –Ω–æ–≤—ã–π —Ñ–∞–π–ª –¥–ª—è —Ä–∞–∑—Ä–µ—à–µ–Ω–∏—è styleId ‚Üí CellStyle
- ‚úÖ `src/components/EditableGridView.tsx` - –ò–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞–Ω resolveCellStyle() –∏ –ø—Ä–∏–º–µ–Ω–µ–Ω–∏–µ —Å—Ç–∏–ª–µ–π –∫ —è—á–µ–π–∫–∞–º
- ‚úÖ `src/components/WorkbookViewer.tsx` - –ü–µ—Ä–µ–¥–∞—á–∞ workbook –≤ EditableGridView

**–ß—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç:**
- –ü–∞—Ä—Å–∏–Ω–≥ –≤—Å–µ—Ö —à—Ä–∏—Ñ—Ç–æ–≤ (name, size, bold, italic, underline, strikethrough, color)
- –ü–∞—Ä—Å–∏–Ω–≥ –≤—Å–µ—Ö –∑–∞–ª–∏–≤–æ–∫ (pattern type, fgColor, bgColor)
- –ü–∞—Ä—Å–∏–Ω–≥ –≤—Å–µ—Ö –≥—Ä–∞–Ω–∏—Ü (left, right, top, bottom —Å style –∏ color)
- –ü–∞—Ä—Å–∏–Ω–≥ alignment (horizontal, vertical, wrapText, textRotation, indent)
- –ö–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏—è ARGB ‚Üí HEX —Ü–≤–µ—Ç–æ–≤
- –ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ –≤—Å–µ—Ö —Å—Ç–∏–ª–µ–π –≤ UI —á–µ—Ä–µ–∑ customStyle

#### Etap 1.2: –£–ª—É—á—à–µ–Ω–Ω–∞—è –ø–æ–¥–¥–µ—Ä–∂–∫–∞ merged cells ‚úÖ
**–î–∞—Ç–∞:** 2025-10-05

**–†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã:**
- ‚úÖ `src/core-ts/merge-utils.ts` - –°–æ–∑–¥–∞–Ω –Ω–æ–≤—ã–π —Ñ–∞–π–ª —Å —É—Ç–∏–ª–∏—Ç–∞–º–∏ –¥–ª—è merged cells
- ‚úÖ `src/components/EditableGridView.tsx` - –ò–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞–Ω–∞ –ª–æ–≥–∏–∫–∞ —Å–∫—Ä—ã—Ç–∏—è slave cells –∏ —Ä–∞—Å—Ç—è–∂–µ–Ω–∏—è master cells
- ‚úÖ `src/core-ts/write_xlsx.ts` - –î–æ–±–∞–≤–ª–µ–Ω–∞ –ø–æ–¥–¥–µ—Ä–∂–∫–∞ —ç–∫—Å–ø–æ—Ä—Ç–∞ merged cells

**–ß—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç:**
- parseRange() - –ø–∞—Ä—Å–∏–Ω–≥ "A1:B3" –≤ –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç—ã
- shouldHideCell() - –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ slave cells –¥–ª—è —Å–∫—Ä—ã—Ç–∏—è
- getMergedCellSize() - —Ä–∞—Å—á–µ—Ç rowSpan/colSpan –¥–ª—è master cells
- CSS Grid span –¥–ª—è –≤–∏–∑—É–∞–ª—å–Ω–æ–≥–æ –æ–±—ä–µ–¥–∏–Ω–µ–Ω–∏—è —è—á–µ–µ–∫
- –≠–∫—Å–ø–æ—Ä—Ç merged ranges –≤ .xlsx

#### Etap 1.3: –ü–æ–ª–Ω–∞—è –ø–æ–¥–¥–µ—Ä–∂–∫–∞ —Ñ–æ—Ä–º—É–ª ‚úÖ
**–î–∞—Ç–∞:** 2025-10-05

**–†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã:**
- ‚úÖ `src/core-ts/read_xlsx.ts` - –î–æ–±–∞–≤–ª–µ–Ω –ø–∞—Ä—Å–∏–Ω–≥ —Ç–µ–≥–∞ `<f>` –¥–ª—è —Ñ–æ—Ä–º—É–ª

**–ß—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç:**
- –ß—Ç–µ–Ω–∏–µ —Ñ–æ—Ä–º—É–ª –∏–∑ `<f>` —Ç–µ–≥–∞ –≤ xl/worksheets/sheetN.xml
- –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ —Ñ–æ—Ä–º—É–ª –≤ CellData.formula
- –û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ —Ñ–æ—Ä–º—É–ª –≤ FormulaBar (—á–µ—Ä–µ–∑ getCellValue)
- –í—ã—á–∏—Å–ª–µ–Ω–∏–µ —Ñ–æ—Ä–º—É–ª —á–µ—Ä–µ–∑ HyperFormula (—É–∂–µ –±—ã–ª–æ)
- –≠–∫—Å–ø–æ—Ä—Ç —Ñ–æ—Ä–º—É–ª –≤ .xlsx (—É–∂–µ –±—ã–ª–æ –≤ write_xlsx.ts)

#### Etap 1.4: –ü–æ–ª–Ω–∞—è –ø–æ–¥–¥–µ—Ä–∂–∫–∞ —á–∏—Å–ª–æ–≤—ã—Ö —Ñ–æ—Ä–º–∞—Ç–æ–≤ ‚úÖ
**–î–∞—Ç–∞:** 2025-10-05

**–†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã:**
- ‚úÖ `src/core-ts/number-formatter.ts` - –°–æ–∑–¥–∞–Ω –Ω–æ–≤—ã–π —Ñ–∞–π–ª –¥–ª—è —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏—è —á–∏—Å–µ–ª
- ‚úÖ `src/hooks/useSpreadsheetEditor.ts` - –ò–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞–Ω formatNumber() –≤ getCellDisplayValue()

**–ß—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç:**
- –ü–æ–¥–¥–µ—Ä–∂–∫–∞ –≤—Å–µ—Ö –≤—Å—Ç—Ä–æ–µ–Ω–Ω—ã—Ö —Ñ–æ—Ä–º–∞—Ç–æ–≤ (0-49)
- –ü–æ–¥–¥–µ—Ä–∂–∫–∞ custom —Ñ–æ—Ä–º–∞—Ç–æ–≤ –∏–∑ workbook.numFmts
- –§–æ—Ä–º–∞—Ç—ã: –ø—Ä–æ—Ü–µ–Ω—Ç–æ–≤, –≤–∞–ª—é—Ç—ã, –Ω–∞—É—á–Ω–æ–π –Ω–æ—Ç–∞—Ü–∏–∏, –¥–∞—Ç, –≤—Ä–µ–º–µ–Ω–∏
- –ö–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏—è Excel serial date ‚Üí JavaScript Date
- –ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ —Ñ–æ—Ä–º–∞—Ç–æ–≤ –∫ —Ñ–æ—Ä–º—É–ª—å–Ω—ã–º –∏ –æ–±—ã—á–Ω—ã–º —è—á–µ–π–∫–∞–º

**–†–µ–∑—É–ª—å—Ç–∞—Ç Phase 1:**
- üéØ **~75% –≤–∏–∑—É–∞–ª—å–Ω–æ–π –∏–¥–µ–Ω—Ç–∏—á–Ω–æ—Å—Ç–∏ –¥–æ—Å—Ç–∏–≥–Ω—É—Ç–æ!**
- –í—Å–µ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –≤–∏–∑—É–∞–ª—å–Ω—ã–µ —ç–ª–µ–º–µ–Ω—Ç—ã —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω—ã
- Build —É—Å–ø–µ—à–µ–Ω, –æ—à–∏–±–æ–∫ –Ω–µ—Ç

---

## üöÄ –°–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏

### Phase 2: –†–∞—Å—à–∏—Ä–µ–Ω–Ω–æ–µ —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ (3-4 –¥–Ω—è) ‚Üí 85% –∏–¥–µ–Ω—Ç–∏—á–Ω–æ—Å—Ç–∏

#### Etap 2.1: –£—Å–ª–æ–≤–Ω–æ–µ —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ
- [ ] –ü–∞—Ä—Å–∏–Ω–≥ xl/worksheets/sheet1.xml ‚Üí `<conditionalFormatting>`
- [ ] –ü–æ–¥–¥–µ—Ä–∂–∫–∞ Data Bars, Color Scales, Icon Sets
- [ ] –ü–æ–¥–¥–µ—Ä–∂–∫–∞ —Ñ–æ—Ä–º—É–ª-—É—Å–ª–æ–≤–∏–π
- [ ] –í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è –≤ UI

#### Etap 2.2: Data Validation
- [ ] –ü–∞—Ä—Å–∏–Ω–≥ `<dataValidations>`
- [ ] –ü–æ–¥–¥–µ—Ä–∂–∫–∞ dropdown —Å–ø–∏—Å–∫–æ–≤
- [ ] –í–∞–ª–∏–¥–∞—Ü–∏—è –≤–≤–æ–¥–∞

#### Etap 2.3: –ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏
- [ ] –ü–∞—Ä—Å–∏–Ω–≥ xl/comments1.xml
- [ ] –í–∏–∑—É–∞–ª—å–Ω—ã–µ –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä—ã –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–µ–≤
- [ ] Hover-–ø—Ä–µ–≤—å—é –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–µ–≤

### Phase 3: –ì—Ä–∞—Ñ–∏—á–µ—Å–∫–∏–µ —ç–ª–µ–º–µ–Ω—Ç—ã (3-4 –¥–Ω—è) ‚Üí 95% –∏–¥–µ–Ω—Ç–∏—á–Ω–æ—Å—Ç–∏

#### Etap 3.1: –ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è
- [ ] –ü–∞—Ä—Å–∏–Ω–≥ xl/drawings/drawing1.xml
- [ ] –ò–∑–≤–ª–µ—á–µ–Ω–∏–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π –∏–∑ xl/media/
- [ ] –ü–æ–∑–∏—Ü–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π

#### Etap 3.2: –¢–∞–±–ª–∏—Ü—ã (Tables)
- [ ] –ü–∞—Ä—Å–∏–Ω–≥ xl/tables/table1.xml
- [ ] –í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è headers, filters, totals

#### Etap 3.3: –î–∏–∞–≥—Ä–∞–º–º—ã (Charts)
- [ ] –ü–∞—Ä—Å–∏–Ω–≥ xl/charts/chart1.xml
- [ ] –†–µ–Ω–¥–µ—Ä–∏–Ω–≥ —Ä–∞–∑–ª–∏—á–Ω—ã—Ö —Ç–∏–ø–æ–≤ –¥–∏–∞–≥—Ä–∞–º–º

---

**–ü–æ—Å–ª–µ–¥–Ω–µ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ:** 2025-10-05
**–í–µ—Ä—Å–∏—è –¥–æ–∫—É–º–µ–Ω—Ç–∞:** 1.1
**–°—Ç–∞—Ç—É—Å:** Phase 1 Complete ‚úÖ | Phase 2 Ready üöÄ
